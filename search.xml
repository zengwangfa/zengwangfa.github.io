<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>夜</title>
      <link href="/2025/10/25/ye/"/>
      <url>/2025/10/25/ye/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被纠正，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="22147f0ba88e931e34f41770db02fb6ec7ec38b517267756cbe9ec1b40e2b844">1d621d107eecb08cb114bf54a2314bea52433928ce111f3ec8ffcb70bb2f9be4e6b79a63ef335712c014be94f651192313d6c8494930ae876c213d1622ac5614c483c0f0891c0162171c3ab1115299b55c39520cf76f13abf91298bbccd935f4d301a5c6e6deb9fe21f6cee940d78915476e47f13fc489eef4948e6e261df555adf5ca5b6d143cd5c257ce5a2ab34a3c3acfcd1d83f269f6bac82ae829d61977c1670c1abce4c21eddbd4611d9bf59d2791fada973a22ceb3111076c12d400a1bb18a65d5aad6d6e10234209edb1e698b23774e9c4ad288710f8b828f80287bb6b1b7d64e79d1bc378ca3037365d226c7884d93b6cf58b77d52f79e9e1a696be</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入密码：</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LCD硬件原理及初始化</title>
      <link href="/2019/12/31/s3c2440-lcd/"/>
      <url>/2019/12/31/s3c2440-lcd/</url>
      
        <content type="html"><![CDATA[<h2 id="1-LCD与OLED的区别"><a href="#1-LCD与OLED的区别" class="headerlink" title="1.LCD与OLED的区别"></a>1.LCD与OLED的区别</h2><ul><li><p><strong>LCD背光源与OLED自发光</strong></p></li><li><p>LCD无机材料，LCD寿命较长。OLED广视角、几乎无穷高的对比度、可以弯曲、较低耗电优点。<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd&amp;oled.png" alt="LCD与OLED结构差异"></p></li></ul><h2 id="2-LCD原理"><a href="#2-LCD原理" class="headerlink" title="2.LCD原理"></a>2.LCD原理</h2><ul><li>屏幕上的每一个点称为像素</li><li>每个像素点由RGB三原色组成<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_scan.gif" alt="LCD Display a picture"></li></ul><h3 id="2-1-颜色如何确定？"><a href="#2-1-颜色如何确定？" class="headerlink" title="2.1 颜色如何确定？"></a>2.1 颜色如何确定？</h3><ul><li>由RGB三组信号线组成</li><li>由下原理图可知：R5条、G6条，B5条，即<code>RGB565</code>（彩色模式, <strong>一个像素占两个字节</strong>）</li><li>因此其每个像素占用多少位（<strong>BBP</strong>：bit per piexl）为2个字节<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_circuit.png"></li></ul><h3 id="2-2-LCD如何“行扫描”？"><a href="#2-2-LCD如何“行扫描”？" class="headerlink" title="2.2 LCD如何“行扫描”？"></a>2.2 LCD如何“行扫描”？</h3><ul><li>有一条CLK时钟线与LCD相连，每发出一次CLK(高低电平)，就移动一个像素。</li></ul><h3 id="2-3-如何跳到下一行进行“行扫描”？"><a href="#2-3-如何跳到下一行进行“行扫描”？" class="headerlink" title="2.3 如何跳到下一行进行“行扫描”？"></a>2.3 如何跳到下一行进行“行扫描”？</h3><ul><li>有一条HSYNC（<strong>水平同步信号</strong>）信号线与LCD相连，每发出一次脉冲(高低电平)，行扫描跳到下一行的起始位置。</li></ul><h3 id="2-4-如何进行下一个“场扫描”？"><a href="#2-4-如何进行下一个“场扫描”？" class="headerlink" title="2.4 如何进行下一个“场扫描”？"></a>2.4 如何进行下一个“场扫描”？</h3><ul><li>有一条VSYNC（<strong>垂直同步信号</strong>）信号线与LCD相连，每发出一次脉冲(高低电平)，就跳到原点。</li></ul><hr><blockquote><p>注意：RGB数据线上的数据从何而来？<br>内存里面手动划分一块显存(FrameBuffer)，里面存放了要显示的数据，LCD控制器从里面将数据读出来，通过RGB三组线传给LCD，再依次打到显示屏上。</p></blockquote><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_pin.png" alt="信号引脚标"></p><h2 id="3-LCD时序"><a href="#3-LCD时序" class="headerlink" title="3.LCD时序"></a>3.LCD时序</h2><ul><li>分辨率 = Hsync的个数 * 一行中的有效CLK</li></ul><p>完整时序图：<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_timing_diagram.png" alt="完整时序图"><br>形象时序图：<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_timing_xy.png" alt="形象时序图"></p><blockquote><p>以上两张图可以解释LCD控制时序中的<code>Hsync</code>与<code>Vsync</code>的协同（可以理解 一帧是一个垂直同步信号、一行是一个水平同步信号）</p><ul><li>1.首先一帧（Vsync）中有若干个行（Hsync），设为y，Vsync发出帧脉冲宽度<code>Tvp</code></li><li>2.经过 <code>Tvb</code> 时间，才可以发送一帧的数据，从第一行开始</li><li>3.其次一行（Hsync）中有若干个时钟信号（CLK），有效的设为x，Hsync发出脉冲宽度<code>Thp</code></li><li>4.经过 <code>Thb</code> 时间，才可以发送一行的数据</li><li>5.直到发送到一行的最后一个像素，经过 <code>Thf</code> 时间，才会有下一个水平同步信号（Hsync）</li><li>6.直到发送到最后一行，经过 <code>Tvf</code> 时间，才会有下一个垂直同步信号（Vsync）</li></ul></blockquote><p><strong>由上可知几个重要的信号引脚</strong>：<code>Hsync</code>、<code>Vsync</code> 、<code>CLK</code>、<code>Dn</code><br><strong>由上可知几个重要的时间参数</strong>：<code>Tvp</code>、<code>Tvb</code> 、<code>Thp</code>、<code>Thb</code>、<code>Thf</code> 、<code>Tvf</code> </p><h2 id="4-LCD控制器"><a href="#4-LCD控制器" class="headerlink" title="4.LCD控制器"></a>4.LCD控制器</h2><p>思路：</p><ul><li>1.取数据：把<code>FrameBuffer</code>的地址、<code>bpp</code>、<code>分辨率</code>告诉LCD控制器</li><li>2.发数据：把时序告诉LCD控制器、并设置引脚的极性（本款是下降沿取数据，但是有的LCD是上升沿有效，因此需要设置极性）</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_controller_diagram.png" alt="LCD结构图"></p><h3 id="4-1-像素数据格式"><a href="#4-1-像素数据格式" class="headerlink" title="4.1 像素数据格式"></a>4.1 像素数据格式</h3><ul><li>使用的像素数格式如下：16BPP<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_data_format.png" alt="16BPP内存数据格式"></li></ul><p>565数据格式引脚连接图：<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/565_format_pin.png" alt="565数据格式引脚连接图"></p><h3 id="4-2-调色板"><a href="#4-2-调色板" class="headerlink" title="4.2 调色板"></a>4.2 调色板</h3><ul><li>本应该用<code>FrameBuffer</code>中用16bit表示1像素，可以用8bit存放在<code>FrameBuffer</code>来省空间</li><li>8bit存放的是调色板中颜色的索引（共256中16bit颜色）<blockquote><p>那么当使用像素深度为8pp时候，像素深度和我们的带宽不一致，我们的颜色要用16位表示，如果直接用上肯定不可能，那我们就可以选择用调色板，<strong>调色板中存放了256种16bpp的颜色</strong>，这时候我们color存放的就不是真实的颜色值了，而是存放的是调色板中256种颜色的<code>索引</code>，成线性关系一一对应，这样我们大大减轻了系统的负担。用16bpp还是8bpp这得取决实际情况，16bpp肯定比8pp清晰，但同时带来的负荷也更加重。</p></blockquote></li></ul><p>调色板工作示意图<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_palette.png" alt="调色板工作示意图"><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_8bpp_fornat.png" alt="调色板8BPP"></p><h2 id="5-编程框架"><a href="#5-编程框架" class="headerlink" title="5.编程框架"></a>5.编程框架</h2><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_program_framework.png" alt="LCD编程框架"></p><p>面向对象编程<br>参数层：</p><ul><li>1.抽象出（不同设备）共同的参数结构体</li><li>2.上层的设备结构体指针指向所需的参数结构体</li></ul><hr><p>驱动层</p><ul><li>1.抽象不同平台的LCD控制器结构体</li><li>2.上层的LCD控制器结构体指针指向所需的结构体</li></ul><h2 id="6-结构体参数"><a href="#6-结构体参数" class="headerlink" title="6. 结构体参数"></a>6. 结构体参数</h2><h3 id="6-1-引脚极性结构体"><a href="#6-1-引脚极性结构体" class="headerlink" title="6.1 引脚极性结构体"></a>6.1 引脚极性结构体</h3><p>由上<a href="#3.LCD%E6%97%B6%E5%BA%8F">3.LCD时序</a>可知几个重要的信号引脚：<code>Hsync</code>、<code>Vsync</code> 、<code>CLK</code>、<code>Dn</code>：<code>Hsync</code>、<code>Vsync</code> 、<code>CLK</code>、<code>Dn</code><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/pins_polarity_reg.png" alt="引脚极性寄存器"></p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 引脚极性结构体</span></span><br><span class="line"><span class="comment"> * NORMAL：正常极性</span></span><br><span class="line"><span class="comment"> * INVERT：反转极性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">pins_polarity</span>{</span></span><br><span class="line"><span class="type">int</span> vclk;  <span class="comment">/* normal：下降沿获取数据 */</span></span><br><span class="line"><span class="type">int</span> rgb;   <span class="comment">/* normal：高电平表示1 */</span></span><br><span class="line"><span class="type">int</span> hsync; <span class="comment">/* normal：高脉冲 */</span></span><br><span class="line"><span class="type">int</span> vsync; <span class="comment">/* normal：高脉冲 */</span></span><br><span class="line">}pins_polarity, *p_pins_polarity;</span><br></pre></td></tr></tbody></table></figure><h3 id="6-2-时序结构体"><a href="#6-2-时序结构体" class="headerlink" title="6.2 时序结构体"></a>6.2 时序结构体</h3><p>由上<a href="#3.LCD%E6%97%B6%E5%BA%8F">3.LCD时序</a>可知几个重要的时间参数：<code>Tvp</code>、<code>Tvb</code> 、<code>Thp</code>、<code>Thb</code>、<code>Thf</code> 、<code>Tvf</code> </p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 时序结构体</span></span><br><span class="line"><span class="comment"> * NORMAL：正常极性</span></span><br><span class="line"><span class="comment"> * INVERT：反转极性</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">time_sequence</span>{</span></span><br><span class="line"><span class="comment">/* 垂直方向 */</span></span><br><span class="line"><span class="type">int</span> tvp; <span class="comment">/* Vsync脉冲宽度 */</span></span><br><span class="line"><span class="type">int</span> tvb; <span class="comment">/* 上边黑框 Vertical Back porch */</span></span><br><span class="line"><span class="type">int</span> tvf; <span class="comment">/* 下边黑框 Vertical Front porch */</span></span><br><span class="line"><span class="comment">/* 水平方向 */</span></span><br><span class="line"><span class="type">int</span> thp; <span class="comment">/* Hsync脉冲宽度 */</span></span><br><span class="line"><span class="type">int</span> thb; <span class="comment">/* 左边黑框 Horizontal Back porch*/</span></span><br><span class="line"><span class="type">int</span> tvf; <span class="comment">/* 右边黑框 Horizontal Front porch */</span></span><br><span class="line">}time_sequence,*p_time_sequence;</span><br></pre></td></tr></tbody></table></figure><h3 id="6-3-LCD控制器结构体"><a href="#6-3-LCD控制器结构体" class="headerlink" title="6.3 LCD控制器结构体"></a>6.3 LCD控制器结构体</h3><p>包含初始化、使能、禁止函数</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 抽象LCD控制器结构体</span></span><br><span class="line"><span class="comment"> * 向上：接收不同的LCD参数</span></span><br><span class="line"><span class="comment"> * 向下：使用这些参数设置对应的LCD Controller</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">lcd_controller</span>{</span></span><br><span class="line"><span class="type">void</span> (*init)(p_lcd_params plcdparams); <span class="comment">//初始化</span></span><br><span class="line"><span class="type">void</span> (*enable)(<span class="type">void</span>);  <span class="comment">//使</span></span><br><span class="line"><span class="type">void</span> (*disable)(<span class="type">void</span>); <span class="comment">//禁止 </span></span><br><span class="line"></span><br><span class="line">}lcd_controller,*p_lcd_controller;</span><br></pre></td></tr></tbody></table></figure><h2 id="8-LCD控制器初始化"><a href="#8-LCD控制器初始化" class="headerlink" title="8.LCD控制器初始化"></a>8.LCD控制器初始化</h2><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_timing_conditions.png" alt="LCD时序时间表"></p><h3 id="8-1-LCDCON1"><a href="#8-1-LCDCON1" class="headerlink" title="8.1 LCDCON1"></a>8.1 LCDCON1</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* LCDCON1[17:8] : CLKVAL, vclk = HCLK/[(CLKVAL+1)*2] </span></span><br><span class="line"><span class="comment"> *                              = 100M/[(CLKVAL+1)*2]</span></span><br><span class="line"><span class="comment"> *   CLKVAL = 100/vclk/2 - 1 , vclk</span></span><br><span class="line"><span class="comment"> * [6:5]：0b11，TFT LCD</span></span><br><span class="line"><span class="comment"> * [4:1]：bpp mode</span></span><br><span class="line"><span class="comment"> * [0]  ：LCD video output and the logic enable(1)/disable(0)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> clkval  = (<span class="type">double</span>)<span class="number">100</span>/plcdparams-&gt;time_seq.vclk/<span class="number">2</span> - <span class="number">1</span> + <span class="number">0.5</span>;</span><br><span class="line"><span class="type">int</span> bppmode = (plcdparams ==  <span class="number">8</span>) ? <span class="number">0x0B</span> :\ <span class="comment">//8bpp</span></span><br><span class="line">  (plcdparams == <span class="number">16</span>) ? <span class="number">0x0C</span> :\ <span class="comment">//16bpp</span></span><br><span class="line">  <span class="number">0x0D</span>; <span class="comment">//24bpp </span></span><br><span class="line"></span><br><span class="line">LCDCON1 = (clkval &lt;&lt; <span class="number">8</span>) | (<span class="number">3</span> &lt;&lt; <span class="number">5</span>) | (bppmode &lt;&lt; <span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon1.png"></p><h2 id="7-初始化LCD引脚"><a href="#7-初始化LCD引脚" class="headerlink" title="7.初始化LCD引脚"></a>7.初始化LCD引脚</h2><ul><li>初始LCD专用引脚，配置其模式：<code>LCD Data</code> 与 <code>LCD Control</code></li></ul><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 初始化LCD引脚 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">jz2440_pin_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">/* 初始化 背光引脚： GPB0 */</span></span><br><span class="line">GPBCON &amp;= ~<span class="number">0x03</span>;</span><br><span class="line">GPBCON |= <span class="number">0x01</span>;  <span class="comment">//输出模式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 初始化LCD专用引脚  */</span></span><br><span class="line">GPCCON = <span class="number">0xAAAAAAAA</span>;</span><br><span class="line">GPDCON = <span class="number">0xAAAAAAAA</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 电源引脚 LCD_PWRDN */</span></span><br><span class="line">GPGCON |= (<span class="number">3</span>&lt;&lt;<span class="number">8</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><blockquote><p>为了方便GPC、GPD两组，都设置为LCD专用引脚为 0xAAAAAAAA</p></blockquote><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_mode_pins.png"><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/gpdcon1.png"><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/gpccon1.png"><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_pwren_pin.png"></p><hr><ul><li>由下图S3C2440 LCD控制器时序可得，在设置寄存器时需要在时间参数上-1<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/s3c2440_lcd_timing.png"></li></ul><h3 id="8-2-LCDCON2"><a href="#8-2-LCDCON2" class="headerlink" title="8.2 LCDCON2"></a>8.2 LCDCON2</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  垂直</span></span><br><span class="line"><span class="comment"> *  [31:24] ：VBPD    = Tvb - 1</span></span><br><span class="line"><span class="comment"> *  [23:14] ：LINEVAL = line - 1  行数值</span></span><br><span class="line"><span class="comment"> *  [13:6]  ：VFPD    = Tvf - 1 </span></span><br><span class="line"><span class="comment"> *  [5:0]：VSPW   = Tvp -1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">LCDCON2 = ((plcdparams-&gt;time_seq.tvb <span class="number">-1</span>) &lt;&lt; <span class="number">24</span>) | \</span><br><span class="line">  ((plcdparams-&gt;yres <span class="number">-1</span>) &lt;&lt; <span class="number">14</span>) | \</span><br><span class="line">  ((plcdparams-&gt;time_seq.tvf <span class="number">-1</span>) &lt;&lt; <span class="number">6</span> ) | \</span><br><span class="line">    ((plcdparams-&gt;time_seq.tvp <span class="number">-1</span>) &lt;&lt; <span class="number">0</span> );</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon2_2.png"></p><h3 id="8-3-LCDCON3"><a href="#8-3-LCDCON3" class="headerlink" title="8.3 LCDCON3"></a>8.3 LCDCON3</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  水平    </span></span><br><span class="line"><span class="comment"> *  [31:19] ：HBPD    = Thb - 1</span></span><br><span class="line"><span class="comment"> *  [18:8]  ：HOZVAL  = 列 - 1  横向像素点</span></span><br><span class="line"><span class="comment"> *  [7:0]   ：HFPD    = Thf - 1 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">LCDCON3 = ((plcdparams-&gt;time_seq.thb <span class="number">-1</span>) &lt;&lt; <span class="number">19</span>) | \</span><br><span class="line">  ((plcdparams-&gt;xres <span class="number">-1</span>) &lt;&lt; <span class="number">8</span>) | \</span><br><span class="line">  ((plcdparams-&gt;time_seq.thf <span class="number">-1</span>) &lt;&lt; <span class="number">0</span> );</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon3.png"></p><h3 id="8-4-LCDCON4"><a href="#8-4-LCDCON4" class="headerlink" title="8.4 LCDCON4"></a>8.4 LCDCON4</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  [23:14] ：HSPW = thp - 1  行脉冲宽度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">LCDCON4 = ((plcdparams-&gt;time_seq.thp <span class="number">-1</span>) &lt;&lt; <span class="number">0</span> );</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon4.png"></p><h3 id="8-5-LCDCON5"><a href="#8-5-LCDCON5" class="headerlink" title="8.5 LCDCON5"></a>8.5 LCDCON5</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 用来设置引脚极性, 设置16bpp数据格式, 设置内存中象素存放的格式</span></span><br><span class="line"><span class="comment">    * [12] : BPP24BL,This bit determines the order of 24 bpp video memory.</span></span><br><span class="line"><span class="comment"> * [11] : FRM565, 1-565</span></span><br><span class="line"><span class="comment"> * [10] : INVVCLK, 0 = The video data is fetched at VCLK falling edge</span></span><br><span class="line"><span class="comment"> * [9]  : HSYNC是否反转</span></span><br><span class="line"><span class="comment"> * [8]  : VSYNC是否反转</span></span><br><span class="line"><span class="comment"> * [7]  : INVVD, rgb是否反转</span></span><br><span class="line"><span class="comment"> * [6]  : INVVDEN</span></span><br><span class="line"><span class="comment"> * [5]  : INVPWREN</span></span><br><span class="line"><span class="comment"> * [4]  : INVLEND</span></span><br><span class="line"><span class="comment"> * [3]  : PWREN, LCD_PWREN output signal enable/disable</span></span><br><span class="line"><span class="comment"> * [2]  : ENLEND  </span></span><br><span class="line"><span class="comment"> * [1]  : BSWP</span></span><br><span class="line"><span class="comment"> * [0]  : HWSWP</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">pixelformat = plcdparams-&gt;pins_pol.bpp == <span class="number">24</span> ? (<span class="number">1</span>&lt;&lt;<span class="number">12</span>) : \<span class="comment">//24bpp</span></span><br><span class="line">  plcdparams-&gt;pins_pol.bpp == <span class="number">16</span> ? (<span class="number">1</span>) : \ <span class="comment">//16bpp</span></span><br><span class="line">  (<span class="number">1</span>&lt;&lt;<span class="number">1</span>);<span class="comment">//8ppp</span></span><br><span class="line">LCDCON5 = (plcdparams-&gt;pins_pol.vclk&lt;&lt;<span class="number">10</span>) |\</span><br><span class="line">  (plcdparams-&gt;pins_pol.hsync&lt;&lt;<span class="number">9</span>) |\</span><br><span class="line">  (plcdparams-&gt;pins_pol.vsync&lt;&lt;<span class="number">8</span>) |\</span><br><span class="line">  (plcdparams-&gt;pins_pol.rgb&lt;&lt;<span class="number">7</span>)   |\</span><br><span class="line">  (plcdparams-&gt;pins_pol.de&lt;&lt;<span class="number">6</span>)    |\</span><br><span class="line">  (plcdparams-&gt;pins_pol.pwren&lt;&lt;<span class="number">5</span>) |\</span><br><span class="line">  (<span class="number">1</span>&lt;&lt;<span class="number">11</span>) | pixelformat;</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon5_1.png"><br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon5_2.png"></p><h3 id="8-6-LCDSADDR"><a href="#8-6-LCDSADDR" class="headerlink" title="8.6 LCDSADDR"></a>8.6 LCDSADDR</h3><ul><li>由下图可知：是将fb_base的[30:1]直接写入LCDSADDR1寄存器</li></ul><blockquote><p>起始地址<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdsaddr1.png"></p></blockquote><blockquote><p>结束地址 = 起始地址 + x * y * bpp/8<br>即为：起始地址+一帧所占空间大小<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdsaddr2.png"></p></blockquote><h2 id="9-构造LCD参数结构体"><a href="#9-构造LCD参数结构体" class="headerlink" title="9.构造LCD参数结构体"></a>9.构造LCD参数结构体</h2><blockquote><p>对于该款4.3寸LCD而言的参数设置</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 该款4.3寸 LCD参数结构体 */</span></span><br><span class="line">lcd_params lcd_4_3_params{ </span><br><span class="line">.name = <span class="string">"lcd4.3"</span>,</span><br><span class="line">.pins_pol = {</span><br><span class="line">vclk  = NORMAL,  <span class="comment">/* normal：下降沿获取数据 */</span></span><br><span class="line">hsync = INVERT, <span class="comment">/* normal：高脉冲 */</span></span><br><span class="line">vsync = INVERT, <span class="comment">/* normal：高脉冲 */</span></span><br><span class="line"></span><br><span class="line">rgb   = NORMAL,   <span class="comment">/* normal：高电平表示1 */</span></span><br><span class="line"></span><br><span class="line">de    = NORMAL,    <span class="comment">/* normal：高电平使能 data enable */</span></span><br><span class="line">pwren = NORMAL, <span class="comment">/* normal：高电平使能power enable */</span></span><br><span class="line">},</span><br><span class="line">.time_seq = {</span><br><span class="line"><span class="comment">/* 垂直方向 */</span></span><br><span class="line">tvp = <span class="number">10</span>, <span class="comment">/* Vsync脉冲宽度 */</span></span><br><span class="line">tvb = <span class="number">2</span>, <span class="comment">/* 上边黑框 Vertical Back porch */</span></span><br><span class="line">tvf = <span class="number">2</span>, <span class="comment">/* 下边黑框 Vertical Front porch */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 水平方向 */</span></span><br><span class="line">thp = <span class="number">41</span>, <span class="comment">/* Hsync脉冲宽度 */</span></span><br><span class="line">thb = <span class="number">2</span>, <span class="comment">/* 左边黑框 Horizontal Back porch*/</span></span><br><span class="line">thf = <span class="number">2</span>, <span class="comment">/* 右边黑框 Horizontal Front porch */</span></span><br><span class="line"></span><br><span class="line">vlck = <span class="number">9</span>,<span class="comment">/* MHz */</span></span><br><span class="line">}.</span><br><span class="line">.xres = <span class="number">480</span>,</span><br><span class="line">.yres = <span class="number">272</span>,</span><br><span class="line">.bpp  = <span class="number">16</span>,  <span class="comment">/* 16bit */</span></span><br><span class="line">.fb_base,</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/lcd_timing_params.png"></p>]]></content>
      
      
      <categories>
          
          <category> S3C2440 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ARM9 </tag>
            
            <tag> LCD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nand Flash编程</title>
      <link href="/2019/12/27/s3c2440-nand/"/>
      <url>/2019/12/27/s3c2440-nand/</url>
      
        <content type="html"><![CDATA[<h2 id="1-读芯片ID"><a href="#1-读芯片ID" class="headerlink" title="1.读芯片ID"></a>1.读芯片ID</h2><h3 id="1-1-读芯片ID时序"><a href="#1-1-读芯片ID时序" class="headerlink" title="1.1 读芯片ID时序"></a>1.1 读芯片ID时序</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_timing.png"></p><p> 简化为4个步骤：</p><ul><li>1.使能片选</li><li>2.写命令0x90</li><li>3.写地址0x00</li><li>4.读ID信息</li></ul> <figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 识别NAND FLASH */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">scan_nand_flash</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="comment">//保存读取ID信息的数组</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> id_info[<span class="number">5</span>] = {<span class="number">0</span>};</span><br><span class="line"></span><br><span class="line">nand_enable_cs();<span class="comment">//使能CS</span></span><br><span class="line">nand_write_cmd(<span class="number">0x90</span>);</span><br><span class="line">nand_write_addr(<span class="number">0x00</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; <span class="number">5</span>;i++){</span><br><span class="line">id_info[i] = nand_read_data();</span><br><span class="line">}</span><br><span class="line">nand_disable_cs();<span class="comment">//禁止CS</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Maker  Code: 0x%x\r\n"</span>,id_info[<span class="number">0</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Device Code: 0x%x\r\n"</span>,id_info[<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"3rd   cycle: 0x%x\n\r"</span>,id_info[<span class="number">2</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Page   size: %d KB\n\r"</span>,<span class="number">1</span>  &lt;&lt; (id_info[<span class="number">3</span>] &amp; <span class="number">0x03</span>));<span class="comment">//页大小与id_info[3]最低2位有关</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Block  size: %d KB\n\r"</span>,<span class="number">64</span> &lt;&lt; ((id_info[<span class="number">3</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x03</span>));<span class="comment">//块大小与id_info[3]第4、5位有关</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"5th   cycle: 0x%x\n\r"</span>,id_info[<span class="number">4</span>]);</span><br></pre></td></tr></tbody></table></figure><h3 id="1-2-由ID数据获得芯片参数"><a href="#1-2-由ID数据获得芯片参数" class="headerlink" title="1.2 由ID数据获得芯片参数"></a>1.2 由ID数据获得芯片参数</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_scan_test.png"></p><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_chip_params.png"></p><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_scan_test2.png"></p><ul><li>ID信息的第4字节为<code>0x95</code></li><li>页大小与id_info[3]最低2位有关，可得<strong>页大小</strong>为：<code>2KB</code></li><li>块大小与id_info[3]第4、5位有关，可得<strong>块大小</strong>为：<code>128KB</code></li></ul><blockquote><p>注意：如果此时烧写到Nand Flash，并从Nand Flash启动程序是不会成功的，因为这个bin文件大小已经超过了4K，且现在还没有实现nand flash的读函数。</p></blockquote><h2 id="2-读数据"><a href="#2-读数据" class="headerlink" title="2.读数据"></a>2.读数据</h2><blockquote><p>目标：实现从NAND FLASH中启动，重定位所有数据至SDRAM，并实现读取芯片ID数据</p></blockquote><h3 id="2-1-NAND内部结构分析"><a href="#2-1-NAND内部结构分析" class="headerlink" title="2.1 NAND内部结构分析"></a>2.1 NAND内部结构分析</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_struct.png"></p><ul><li>OOB：out of bank（在bank之外）<br>由上图可得：</li><li>1Page = 2KB + 64B</li><li>1Block = 64 * Pages = 128KB + 4KB</li><li>1Device = 2048 * Blocks = 256MB + 8MB</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_data_store.png"></p><ul><li>OOB区的作用：因为nand的缺点是会发生<code>“位反转”</code>，为了解决这个问题，nand中的OOB区，<strong>用于校验数据区的数据是否发生错误</strong>，当有错误时，可以恢复数据。（其本身不存储数据）</li><li>因为OOB中并不存放数据，只是用于校验数据区是否发生错误，因此当CPU读取Nand Flash<strong>第2048</strong>个数据，该数据为 <code>Page1中的第0个byte</code></li></ul><h3 id="2-2-地址序列与时序"><a href="#2-2-地址序列与时序" class="headerlink" title="2.2 地址序列与时序"></a>2.2 地址序列与时序</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_addr.png"></p><ul><li>由地址序列可以看出：发出地址信号共需5个周期，前2个周期发出列地址（Column Address），后3个周期发出行地址（Row Address）</li><li>地址线序列有一些位是没有用到的，其目的也是以后兼容更大芯片的nand falsh<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_read_timing.png"></li></ul><blockquote><p>Nand Flash内部结构展开大致如下：<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_struct2.png"></p></blockquote><h3 id="2-3-读数据流程"><a href="#2-3-读数据流程" class="headerlink" title="2.3 读数据流程"></a>2.3 读数据流程</h3><ul><li>1.发出片选信号</li><li>2.发出0x00命令</li><li>3.<strong>发送5个周期的地址（两个列地址，三个行地址（page））</strong></li><li>4.再发送0x30命令</li><li>5.等待就绪</li><li>6.读数据</li><li>7.禁止片选</li></ul><h3 id="2-4-转换所读地址的列与页"><a href="#2-4-转换所读地址的列与页" class="headerlink" title="2.4 转换所读地址的列与页"></a>2.4 转换所读地址的列与页</h3><p>将输入的地址addr转换为：</p><ul><li>列地址（Col Address）<ul><li>page是定位到哪一个页，col变量定位的就是在这个页的偏移量（在这个页上的第几列0~2047）</li></ul></li><li>行地址（页）<ul><li>因为读取数据的时候是一次性读出一页，因此当给出地址addr之后，每一页的数据大小是2K，因此我们可以根据地址知道我们读取的数据是哪一个页</li></ul></li></ul><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> col  = addr % <span class="number">2048</span>;<span class="comment">//列地址  addr &amp;(2048-1); </span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> page = addr / <span class="number">2048</span>;<span class="comment">//行地址（相当于页地址）</span></span><br></pre></td></tr></tbody></table></figure><h3 id="2-5-NAND等待就绪"><a href="#2-5-NAND等待就绪" class="headerlink" title="2.5 NAND等待就绪"></a>2.5 NAND等待就绪</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_nfcon.png"></p><ul><li>当NFSATA[0] = 0时，表示正忙</li><li>当NFSATA[0] = 1时，表示就绪</li></ul><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 等待NAND就绪 */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">nand_wait_ready</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">while</span>(!(NFSTAT &amp; <span class="number">0x01</span>));<span class="comment">//当NFSATA[0] = 1时，表示就绪</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="2-6-读取数据函数"><a href="#2-6-读取数据函数" class="headerlink" title="2.6 读取数据函数"></a>2.6 读取数据函数</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* NAND FLASH读取数据</span></span><br><span class="line"><span class="comment"> * param:读取的地址、存放的地址、读取的长度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">read_nand_data</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> addr,<span class="type">unsigned</span> <span class="type">char</span> *buf,<span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*page是定位到哪一个页，col变量定位的就是在这个</span></span><br><span class="line"><span class="comment"> *页的偏移量（在这个页上的第几列0~2047）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> col  = addr % <span class="number">2048</span>;<span class="comment">//列地址  addr &amp;(2048-1); </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 因为读取数据的时候是一次性读出一页，因此当给出</span></span><br><span class="line"><span class="comment"> * 地址addr之后，每一页的数据大小是2K，因此我们可以</span></span><br><span class="line"><span class="comment"> * 根据地址知道我们读取的数据是哪一个页</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> page = addr / <span class="number">2048</span>;<span class="comment">//行地址（相当于页地址）</span></span><br><span class="line"></span><br><span class="line">nand_enable_cs();<span class="comment">//1.使能CS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(i &lt; len){</span><br><span class="line">nand_write_cmd(<span class="number">0x00</span>);       <span class="comment">//2.发出0x00命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* col addr */</span></span><br><span class="line">nand_write_addr(col &amp; <span class="number">0xFF</span>);<span class="comment">//3.发出地址</span></span><br><span class="line">nand_write_addr((col &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>);  </span><br><span class="line"></span><br><span class="line"> <span class="comment">/* row/page addr */</span></span><br><span class="line">    nand_write_addr(page &amp; <span class="number">0xFF</span>);</span><br><span class="line">    nand_write_addr((page &gt;&gt;  <span class="number">8</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line">nand_write_addr((page &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>);</span><br><span class="line"></span><br><span class="line">nand_write_cmd(<span class="number">0x30</span>);<span class="comment">//4.发出0x30命令</span></span><br><span class="line"></span><br><span class="line">        nand_wait_ready(); <span class="comment">//5.等待就绪</span></span><br><span class="line">        <span class="comment">/* for循环中有2个条件</span></span><br><span class="line"><span class="comment">         * 1.当读到页尾，但还是没有读完，说明需要读取下一页</span></span><br><span class="line"><span class="comment">         * 2.当已经读取指定字节数，则不再读取</span></span><br><span class="line"><span class="comment">         */</span>     </span><br><span class="line">        <span class="keyword">for</span>(; (col &lt; <span class="number">2048</span>) &amp;&amp; (i &lt; len); col++){<span class="comment">//6.读数据</span></span><br><span class="line">        buf[i++] = nand_read_data_byte();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span>(i == len){</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        col = <span class="number">0</span>;</span><br><span class="line">        page++;<span class="comment">//指向下一页</span></span><br><span class="line">}</span><br><span class="line">nand_disable_cs(); <span class="comment">//7.禁止CS</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="2-7-NAND重定位"><a href="#2-7-NAND重定位" class="headerlink" title="2.7 NAND重定位"></a>2.7 NAND重定位</h3><blockquote><p>从Nand Flash启动，此时片内SRAM的地址对应的就是CPU的0地址，如果从Nand Flash启动，2440硬件会把nand Flash前4K的数据复制到片内SRAM,如果Nand Flash上的程序大于4K,那后续数据就会丢失，相当于只重定位了前4K的代码。</p></blockquote><p>如何解决上述问题：</p><ul><li>1.前提：实现了NAND FLASH读取数据函数</li><li>2.代码烧写到NAND FLASH,并从NAND中启动</li><li>3.程序运行到重定位代码的位置判断一下，是从Nand Flash启动还是NOR&nbsp; Flash启动（通过往0地址写数据，因为Nand是支持读写的，所以读出的结果和写的结果一样，而NOR&nbsp;Flash不能像内存一样读写，因此读写的内容是不一致的）</li><li>4.如果从NOR&nbsp;Flash启动，直接使用简单的重定位代码就行，如果是Nand Flash启动，那就是用Nnad&nbsp;Flash的读函数进行代码的重定位。</li></ul><hr><blockquote><p>首先判断从NorFlash or NandFlash中启动</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 检查是否从NorFlash中启动</span></span><br><span class="line"><span class="comment"> * 方法：写0x12345678到0地址，在读取出来，如果得到0x12345678，表示0地址上的内容被修改，即为片内RAM，则为nand启动</span></span><br><span class="line"><span class="comment"> * 原因：原因：nor不能直接写入，写入需要发出一定格式的数据，才能写入</span></span><br><span class="line"><span class="comment"> * 返回0为nand启动，返回1为nor启动</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">isBootFromNorFlash</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *p = (<span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *)<span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> val = *p;<span class="comment">//暂存[0]上的数据</span></span><br><span class="line">*p = <span class="number">0xdeadc0de</span>;<span class="comment">//dead code任意值</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0xdeadc0de</span> == *p){</span><br><span class="line"><span class="comment">/* 写成功，对应nand启动 */</span></span><br><span class="line">*p = val;<span class="comment">//恢复原来的值</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><blockquote><p>重定位代码</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 将除bss段的全部数据拷贝到sdram中</span></span><br><span class="line"><span class="comment"> * 传递形参，原地址src:_start  目标地址dest:__bss_start  长度len:__bss_start-_star</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">copy_to_sdram</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="comment">/* 要从lds文件中获取__code_start、__bss_start</span></span><br><span class="line"><span class="comment"> * 然后从0地址把数据复制到__code_start</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> __code_start,__bss_start; <span class="comment">//声明外部变量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *src  = (<span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *)<span class="number">0</span>; <span class="comment">//flash中0地址 </span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *dest = (<span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *)&amp;__code_start; <span class="comment">//目标地址：sdram中的0x30000000地址</span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *end  = (<span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">int</span> *)&amp;__bss_start;  <span class="comment">//结束地址：bss的起始地址</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> len = (<span class="type">int</span>)&amp;__bss_start - (<span class="type">int</span>)&amp;__code_start;<span class="comment">//获取数据总长度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isBootFromNorFlash()){<span class="comment">//如果从Nor中启动</span></span><br><span class="line"><span class="keyword">while</span>(dest &lt; end){</span><br><span class="line">*dest++ = *src++; <span class="comment">//拷贝</span></span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{<span class="comment">//从Nand中启动,需要先初始化nand，然后重定位代码</span></span><br><span class="line">nand_init();</span><br><span class="line">        <span class="comment">//从 src 复制到 des ,总共复制len字节，也就是重定位的代码</span></span><br><span class="line">read_nand_data((<span class="type">unsigned</span> <span class="type">int</span>)src,(<span class="type">unsigned</span> <span class="type">char</span> *)dest,len);</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="2-7-读数据测试"><a href="#2-7-读数据测试" class="headerlink" title="2.7 读数据测试"></a>2.7 读数据测试</h3><blockquote><p>读取0地址后160bytes的数据，如果跟.bin文件前160字节数据相同，则读取成功，否则读取失败</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 测试函数：读数nand上160bytes数据 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">read_nand_flash</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> i,j;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> addr,hex_addr;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> c,str[<span class="number">16</span>],data[<span class="number">160</span>];</span><br><span class="line"><span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">char</span> *p;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 获得地址 */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"*****Enter the address to read:"</span>);</span><br><span class="line">addr = get_uint();</span><br><span class="line"></span><br><span class="line">read_nand_data(addr,data,<span class="number">160</span>);<span class="comment">//获取到地址上的数据</span></span><br><span class="line">p = (<span class="keyword">volatile</span> <span class="type">unsigned</span> <span class="type">char</span> *)data;<span class="comment">//p指向data,用于打印data数据</span></span><br><span class="line"></span><br><span class="line">hex_addr = addr;<span class="comment">//起始地址</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Read Data:\r\n"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"            00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f\n\r"</span>);</span><br><span class="line"> <span class="comment">/* 长度固定为160 bytes */</span></span><br><span class="line"><span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"0x%08x  "</span>,hex_addr);</span><br><span class="line"><span class="comment">//每行打印16个16进制数</span></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++){</span><br><span class="line">c = *p++;<span class="comment">//读取16个</span></span><br><span class="line">str[j] = c;<span class="comment">//保存字符</span></span><br><span class="line"><span class="comment">//先打印数值</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%02x "</span>,c);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">" | "</span>);</span><br><span class="line"><span class="comment">//后打印字符</span></span><br><span class="line"><span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++){</span><br><span class="line"><span class="keyword">if</span>(str[j] &lt; <span class="number">0x20</span> || str[j] &gt; <span class="number">0x7e</span>){<span class="comment">//不可视字符,打印‘.’</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"."</span>);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%c"</span>,str[j]);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">hex_addr+=<span class="number">16</span>;<span class="comment">//换行+16</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n\r"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_bin_data.png"></p><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_read_test2.png"><br>由上测试可知读取成功</p><h2 id="3-擦除"><a href="#3-擦除" class="headerlink" title="3.擦除"></a>3.擦除</h2><h3 id="3-1-擦除时序"><a href="#3-1-擦除时序" class="headerlink" title="3.1 擦除时序"></a>3.1 擦除时序</h3><ul><li>1.发出片选信号</li><li>2.发出0x60命令</li><li>3.<strong>发送3个行地址（page）</strong></li><li>4.再发送0xD0命令</li><li>5.等待就绪（等待擦除完成）</li><li>6.禁止片选</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_erase_timing.png"></p><h3 id="3-2-地址和参数合法性"><a href="#3-2-地址和参数合法性" class="headerlink" title="3.2 地址和参数合法性"></a>3.2 地址和参数合法性</h3><ul><li>由于按块来擦除（128KB），因此地址和参数都必须是128K的倍数</li><li></li></ul><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 检查参数合法性 */</span></span><br><span class="line"><span class="keyword">if</span>(addr &amp; (<span class="number">0x1FFFF</span>)){ <span class="comment">//128K</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Err addr! Please enter an integral multiple of 128K\r\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(len &amp; (<span class="number">0x1FFFF</span>)){ <span class="comment">//128K</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Err len! Please enter an integral multiple of 128K\r\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="3-3-擦除函数"><a href="#3-3-擦除函数" class="headerlink" title="3.3 擦除函数"></a>3.3 擦除函数</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* NAND FLASH擦除数据</span></span><br><span class="line"><span class="comment"> * param:擦除的起始地址、擦除的长度(byte)</span></span><br><span class="line"><span class="comment"> * ret:失败-1，成功0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">erase_nand_data</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> addr,<span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> page = addr / <span class="number">2048</span>;<span class="comment">//行地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 检查参数合法性 */</span></span><br><span class="line"><span class="keyword">if</span>(addr &amp; (<span class="number">0x1FFFF</span>)){ <span class="comment">//128K</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Err addr! Please enter an integral multiple of 128K\r\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>(len &amp; (<span class="number">0x1FFFF</span>)){ <span class="comment">//128K</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Err len! Please enter an integral multiple of 128K\r\n"</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">/* 1.使能CS */</span></span><br><span class="line">nand_enable_cs();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">{</span><br><span class="line">page = addr / <span class="number">2048</span>;<span class="comment">//行地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 2.发出0x60命令 */</span></span><br><span class="line">nand_write_cmd(<span class="number">0x60</span>); </span><br><span class="line"><span class="comment">/* 3.发出地址row/page addr */</span></span><br><span class="line">nand_page(page);      </span><br><span class="line"><span class="comment">/* 4.发出0xD0命令 */</span></span><br><span class="line">nand_write_cmd(<span class="number">0xD0</span>); </span><br><span class="line"><span class="comment">/* 5.等待就绪(等待擦除完成) */</span></span><br><span class="line">nand_wait_ready();    </span><br><span class="line"></span><br><span class="line">len -= (<span class="number">128</span>*<span class="number">1024</span>);<span class="comment">//长度减去一个block</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span> == len){</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">}</span><br><span class="line">addr += (<span class="number">128</span>*<span class="number">1024</span>);<span class="comment">//指向下一块</span></span><br><span class="line">} </span><br><span class="line"><span class="comment">/* 6.禁止CS */</span></span><br><span class="line">nand_disable_cs();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="3-4-擦除数据测试"><a href="#3-4-擦除数据测试" class="headerlink" title="3.4 擦除数据测试"></a>3.4 擦除数据测试</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 擦除测试函数：固定擦除一个1block = 128K</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">erase_nand_flash</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> addr;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> whichblock;</span><br><span class="line"><span class="comment">/* 获得第几个Block */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Enter the address of sector to erase: "</span>);</span><br><span class="line">addr = get_uint();</span><br><span class="line"></span><br><span class="line">whichblock = addr / (<span class="number">128</span>*<span class="number">1024</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** block number : [ %d ]\r\n"</span>,whichblock);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 提示擦除数据的范围 */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** Erase range : 0x%08x - 0x%08x\n\r"</span>,addr,(addr+(<span class="number">128</span>*<span class="number">1024</span>)));</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">"***** erase ...\r\n"</span>);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(erase_nand_data(addr,<span class="number">128</span>*<span class="number">1024</span>) == <span class="number">0</span>){<span class="comment">//如果擦除成功</span></span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">"***** Erase finished!\r\n"</span>);</span><br><span class="line"> }</span><br><span class="line"> <span class="keyword">else</span>{</span><br><span class="line"> <span class="built_in">printf</span>(<span class="string">"***** Erase fail!\r\n"</span>);</span><br><span class="line"> }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_erase_test.png"></p><h2 id="4-写数据"><a href="#4-写数据" class="headerlink" title="4.写数据"></a>4.写数据</h2><h3 id="4-1-写数据时序"><a href="#4-1-写数据时序" class="headerlink" title="4.1 写数据时序"></a>4.1 写数据时序</h3><ul><li>1.发出片选信号</li><li>2.发出0x80命令</li><li>3.<strong>发送5个周期的地址（两个列地址，三个行地址（page））</strong></li><li>4.写入数据</li><li>5.再发送0x10命令</li><li>6.等待就绪（等待擦除完成）</li><li>7.禁止片选<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_wriet_timing.png"></li></ul><h3 id="4-2-写数据函数"><a href="#4-2-写数据函数" class="headerlink" title="4.2 写数据函数"></a>4.2 写数据函数</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* NAND FLASH写入数据</span></span><br><span class="line"><span class="comment"> * param:写入的地址、数据指针、写入的长度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">write_nand_data</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> addr,<span class="type">unsigned</span> <span class="type">char</span> *buf,<span class="type">unsigned</span> <span class="type">int</span> len)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> page = addr / <span class="number">2048</span>;</span><br><span class="line"><span class="type">int</span> col = addr &amp; (<span class="number">2048</span> - <span class="number">1</span>);</span><br><span class="line"><span class="comment">/* 1.使能CS */</span></span><br><span class="line">nand_enable_cs();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>){</span><br><span class="line"><span class="comment">/* 2.发出0x80命令 */</span></span><br><span class="line">nand_write_cmd(<span class="number">0x80</span>);</span><br><span class="line"><span class="comment">/* 3.发出地址 */</span></span><br><span class="line">nand_col(col);</span><br><span class="line">nand_page(page);</span><br><span class="line"><span class="comment">/* 4.写入数据*/</span></span><br><span class="line"><span class="keyword">for</span>(; (col &lt; <span class="number">2048</span>) &amp;&amp; (i &lt; len); ){</span><br><span class="line">nand_write_data_byte(buf[i++]);</span><br><span class="line">}</span><br><span class="line"><span class="comment">/* 5.发出0x10命令 */</span></span><br><span class="line">nand_write_cmd(<span class="number">0x10</span>);</span><br><span class="line"><span class="comment">/* 6.等待就绪(等待写入完成) */</span></span><br><span class="line">nand_wait_ready();</span><br><span class="line"><span class="keyword">if</span>(i == len){</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line">col = <span class="number">0</span>;</span><br><span class="line">page++;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="comment">/* 7.禁止CS */</span></span><br><span class="line">nand_disable_cs();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="4-3-写数据测试"><a href="#4-3-写数据测试" class="headerlink" title="4.3 写数据测试"></a>4.3 写数据测试</h3><blockquote><p>此处注意：一般在烧写数据之前需要对数据进行擦除操作，除非原本的数据全f，否则都需要进行擦除，不然写入的数据会有问题。</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">write_nand_flash</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> addr;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> str[<span class="number">50</span>];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> len;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 获得第几个Block */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** Enter addr to write: "</span>);</span><br><span class="line">addr = get_uint();</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** Enter the string to write: "</span>);</span><br><span class="line">gets(str);</span><br><span class="line">len = <span class="built_in">strlen</span>(str) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** write range : 0x%08x - 0x%08x\r\n"</span>,addr,(addr + len));</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** writing ...\r\n"</span>);</span><br><span class="line"></span><br><span class="line">write_nand_data(addr,str,<span class="built_in">strlen</span>(str)+<span class="number">1</span>);<span class="comment">//strlen不包括结束符'\0'，因此需要+1</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"***** writing finished\r\n"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>在<code>0x100000</code>地址写入“hello,world!”<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_write_test.png"></li><li>读取数据<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_read_test3.png"></li></ul><h2 id="5-判断是否为坏块"><a href="#5-判断是否为坏块" class="headerlink" title="5.判断是否为坏块"></a>5.判断是否为坏块</h2><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/nand_data_store.png"></p><blockquote><p>通过读取OOB区的第0个字节（即第<code>2048</code>个字节）来判断，如果不是0xFF，为坏块，否则不是</p></blockquote><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 判断是否为坏块</span></span><br><span class="line"><span class="comment"> * ret:返回1为坏块，返回0不是</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">isNandBadBlock</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> addr)</span></span><br><span class="line">{</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> col = <span class="number">2048</span>;<span class="comment">//读取OOB区第0个字节</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> page = addr / <span class="number">2048</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> val = <span class="number">0</span>;</span><br><span class="line"><span class="comment">/* 1. 选中 */</span></span><br><span class="line">nand_enable_cs();</span><br><span class="line"><span class="comment">/* 2. 发出读命令00h */</span></span><br><span class="line">nand_write_cmd(<span class="number">0x00</span>);</span><br><span class="line"><span class="comment">/* 3. 发出地址(分5步发出) */</span></span><br><span class="line">nand_col(col);</span><br><span class="line">nand_page(page);</span><br><span class="line"><span class="comment">/* 4. 发出读命令30h */</span></span><br><span class="line">nand_write_cmd(<span class="number">0x30</span>);</span><br><span class="line"><span class="comment">/* 5. 判断状态,等待就绪 */</span></span><br><span class="line">nand_wait_ready();</span><br><span class="line"><span class="comment">/* 6. 读数据 */</span></span><br><span class="line">val = nand_read_data_byte();</span><br><span class="line"><span class="comment">/* 7. 取消选中 */</span></span><br><span class="line">nand_disable_cs();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(val != <span class="number">0xFF</span>){</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>; <span class="comment">/* 坏块 */</span></span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="6-ECC"><a href="#6-ECC" class="headerlink" title="6.ECC"></a>6.ECC</h2><ul><li>ECC（Error Checking and Correction），是一种用于Nand的差错检测和修正算法。</li></ul>]]></content>
      
      
      <categories>
          
          <category> S3C2440 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nand </tag>
            
            <tag> ARM9 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>实用的网站及工具</title>
      <link href="/2019/12/25/websites/"/>
      <url>/2019/12/25/websites/</url>
      
        <content type="html"><![CDATA[<p><img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/web_logo.png"></p><h2 id="学习类"><a href="#学习类" class="headerlink" title="学习类"></a>学习类</h2><h3 id="1-LeetCode：算法必备"><a href="#1-LeetCode：算法必备" class="headerlink" title="1. LeetCode：算法必备"></a>1. LeetCode：算法必备</h3><ul><li><a href="https://leetcode-cn.com//">LeetCode</a><blockquote><p>&nbsp;数据结构与算法，熟悉各互联网公司的算法题目</p></blockquote></li></ul><p>&nbsp;<img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/leetcode.png"></p><h2 id="图片-图标类"><a href="#图片-图标类" class="headerlink" title="图片/图标类"></a>图片/图标类</h2><h3 id="1-Unsplash：优美免费无版权高清图片"><a href="#1-Unsplash：优美免费无版权高清图片" class="headerlink" title="1. Unsplash：优美免费无版权高清图片"></a>1. Unsplash：优美免费无版权高清图片</h3><ul><li><a href="https://unsplash.com/">Unsplash 官网</a> <blockquote><p>优美免费无版权高清图片壁纸设计素材资源网站</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/unsplash.png"></p><h3 id="2-Iconfont：阿里巴巴矢量图标库"><a href="#2-Iconfont：阿里巴巴矢量图标库" class="headerlink" title="2. Iconfont：阿里巴巴矢量图标库"></a>2. Iconfont：阿里巴巴矢量图标库</h3><ul><li><a href="https://www.iconfont.cn/">Iconfont 官网</a> <blockquote><p>Iconfont-阿里巴巴矢量图标库，国内功能很强大且图标内容很丰富的矢量图标库,提供矢量图标下载、在线存储、格式转换等功能</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/iconfont.png"></p><h2 id="设计类"><a href="#设计类" class="headerlink" title="设计类"></a>设计类</h2><h3 id="1-Process-On：免费在线作图，实时协作"><a href="#1-Process-On：免费在线作图，实时协作" class="headerlink" title="1. Process On：免费在线作图，实时协作"></a>1. Process On：免费在线作图，实时协作</h3><ul><li><a href="https://www.processon.com/">ProcessOn 官网</a><blockquote><p>ProcessOn是一个在线作图工具的聚合平台，它可以在线画流程图、思维导图、UI原型图、UML、网络拓扑图、组织结构图等等。</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/processon.png"></p><h3 id="2-3DContentCentral：免费-3D-CAD-模型"><a href="#2-3DContentCentral：免费-3D-CAD-模型" class="headerlink" title="2. 3DContentCentral：免费 3D CAD 模型"></a>2. 3DContentCentral：免费 3D CAD 模型</h3><ul><li><a href="https://www.3dcontentcentral.cn/">3DContentCentral 官网</a><blockquote><p>免费 3D CAD 模型、2D 工程图和供应商目录</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/3dcontentcentral.png"></p><h2 id="办公类"><a href="#办公类" class="headerlink" title="办公类"></a>办公类</h2><h3 id="1-Worktile：团队协作，任务分配"><a href="#1-Worktile：团队协作，任务分配" class="headerlink" title="1. Worktile：团队协作，任务分配"></a>1. Worktile：团队协作，任务分配</h3><ul><li><a href="https://worktile.com/">Worktile 官网</a><blockquote><p>Worktile 是一站式敏捷研发与DevOps平台，提升研发效能，助力更好更快地发布产品。</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/worktile.png"></p><h2 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h2><h3 id="1-ALLDATASHEET：必备的数据手网站"><a href="#1-ALLDATASHEET：必备的数据手网站" class="headerlink" title="1. ALLDATASHEET：必备的数据手网站"></a>1. ALLDATASHEET：必备的数据手网站</h3><ul><li><a href="https://www.alldatasheet.com/">ALLDATASHEET 官网</a><blockquote><p>不用注册，而且是免费的，Alldatasheet向所有的人免费提供半导体以及电子产品数据表Alldatasheet 的主要使用群是从事工程师&amp;工程设计管理以及设计&amp;开发等。</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/alldatasheet.png"></p><h3 id="2-Shields：Github徽章"><a href="#2-Shields：Github徽章" class="headerlink" title="2. Shields：Github徽章"></a>2. Shields：Github徽章</h3><ul><li><a href="https://shields.io/">Shields 官网</a><blockquote><p>开源项目的质量数据标识</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/shields.png"></p><h3 id="3-CodeIF：变量命名神器"><a href="#3-CodeIF：变量命名神器" class="headerlink" title="3. CodeIF：变量命名神器"></a>3. CodeIF：变量命名神器</h3><ul><li><a href="https://unbug.github.io/codelf/">CodeIF 官网</a><blockquote><p>通过搜索GitHub, Bitbucket, GitLab来找到真实的使用变量名</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/codeif.png"></p><h3 id="4-印象笔记：全平台电子笔记"><a href="#4-印象笔记：全平台电子笔记" class="headerlink" title="4. 印象笔记：全平台电子笔记"></a>4. 印象笔记：全平台电子笔记</h3><ul><li><a href="https://www.yinxiang.com/">印象笔记 官网</a><blockquote><p>一站式地完成信息的收集备份、永久保存和高效整理。模板、清单、思维导图、印象笔记·剪藏等多种特色功能，全面提升你的日常效率。</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/yinxiang.png"></p><h3 id="5-牛客：求职必备网站"><a href="#5-牛客：求职必备网站" class="headerlink" title="5. 牛客：求职必备网站"></a>5. 牛客：求职必备网站</h3><ul><li><a href="https://www.nowcoder.com/">牛客 官网</a><blockquote><p>面经、面试题、求职信息</p></blockquote></li></ul><p> <img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/newcoder.png"></p><h3 id="6-MaHua：在线markdown编辑器"><a href="#6-MaHua：在线markdown编辑器" class="headerlink" title="6.MaHua：在线markdown编辑器"></a>6.MaHua：在线markdown编辑器</h3><ul><li><a href="http://mahua.jser.me/">MaHua 官网</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 效率工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用七牛云+PicGo进行图片管理与上传</title>
      <link href="/2019/12/15/qiniu-picgo-img/"/>
      <url>/2019/12/15/qiniu-picgo-img/</url>
      
        <content type="html"><![CDATA[<h2 id="1-注册七牛云账号"><a href="#1-注册七牛云账号" class="headerlink" title="1.注册七牛云账号"></a>1.注册七牛云账号</h2><ul><li><a href="https://portal.qiniu.com/signup">点击注册七牛云</a></li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_signup.png" alt="注册七牛云"></p><blockquote><p>需要<strong>实名认证</strong>，认证之后再进行上传图片<br>点击进入“个人中心”-&gt; “个人信息”，进行实名认证，即有10G免费存储空间</p></blockquote><h2 id="2-创建标准存储空间"><a href="#2-创建标准存储空间" class="headerlink" title="2.创建标准存储空间"></a>2.创建标准存储空间</h2><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_controller.png" alt="点击进入控制台"></p><h3 id="2-1-添加对象存储"><a href="#2-1-添加对象存储" class="headerlink" title="2.1 添加对象存储"></a>2.1 添加对象存储</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_store.png" alt="点击对象存储"></p><h3 id="2-2-设置存储空间"><a href="#2-2-设置存储空间" class="headerlink" title="2.2 设置存储空间"></a>2.2 设置存储空间</h3><p>存储空间名称：自行命名<br>存储区域：选与你地域较近的区域<br>访问控制：选“公开空间”，否则外网无法访问<br><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_store_setting.png" alt="存储空间设置"></p><h3 id="2-3-上传图片"><a href="#2-3-上传图片" class="headerlink" title="2.3 上传图片"></a>2.3 上传图片</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_upload.png" alt="上传图片"></p><h3 id="2-4-获取图片外链"><a href="#2-4-获取图片外链" class="headerlink" title="2.4 获取图片外链"></a>2.4 获取图片外链</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_copy_url.png" alt="获取图片外链"></p><h2 id="3-使用PicGo进行管理与上传"><a href="#3-使用PicGo进行管理与上传" class="headerlink" title="3.使用PicGo进行管理与上传"></a>3.使用PicGo进行管理与上传</h2><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/picgo.png" alt="PicGo"></p><ul><li><a href="https://github.com/Molunerfinn/PicGo/releases">点击下载PicGo</a></li></ul><h3 id="3-1-设置七牛图床"><a href="#3-1-设置七牛图床" class="headerlink" title="3.1 设置七牛图床"></a>3.1 设置七牛图床</h3><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/picgo_qiniu_setting.png" alt="设置七牛图床"></p><ul><li>1.获得AK与SK</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_ak_sk.png"></p><ul><li>2.存储空间名要与之前创建的空间名移植</li><li>3.获得访问网址</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/qiniu_copy_web.png" alt="访问网址"></p><h3 id="3-2-复制外链"><a href="#3-2-复制外链" class="headerlink" title="3.2 复制外链"></a>3.2 复制外链</h3><p>上传完的图片就会在相册中，并且预览、复制链接</p><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/picgo_photos.png"></p><h3 id="3-3-自定义链接格式"><a href="#3-3-自定义链接格式" class="headerlink" title="3.3 自定义链接格式"></a>3.3 自定义链接格式</h3><ul><li><code>Custom</code>模式可以自定义链接格式</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/picgo_set_url.png"></p><p>-用占位符<code>$url</code>来表示ul的位置</p><ul><li>用占位符<code>$fileName</code>来表示文件名的位置</li></ul><p><img src="https://ian-study.oss-cn-shanghai.aliyuncs.com/picgo_set_by_custom.png" alt="自定义链接格式"></p><p>点击复制，就会按照自定义的格式复制链接，eg：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![在这里描述图片](https://ian-study.oss-cn-shanghai.aliyuncs.com/lcdcon1.png)</span><br></pre></td></tr></tbody></table></figure><h3 id="3-4-PicGo插件"><a href="#3-4-PicGo插件" class="headerlink" title="3.4 PicGo插件"></a>3.4 PicGo插件</h3><ul><li><a href="https://github.com/PicGo/Awesome-PicGo">点击进入PicGo插件合集页面</a></li></ul><hr><ul><li><a href="https://github.com/PicGo/picgo-plugin-autocopy">PicGo -plugin-autocopy</a>:用于上传后将url自动复制到剪贴板的PicGo插件。【CLI】</li><li><a href="https://github.com/zWingz/picgo-plugin-github-plus">PicGo -plugin-github-plus</a>: PicGo上传github &amp; gitee同步功能。【GUI】</li><li><a href="https://github.com/picgo/picgo-plugin-pico-migrater">PicGo -plugin- pico -migrater</a> :一个PicGo插件，用于将markdown文件中的图片从一个picBed迁移到另一个picBed。【CLI&amp;GUI】</li><li><a href="https://github.com/yuki-xin/picgo-plugin-web-uploader">PicGo -plugin-web-uploader</a>: PicGo上传自定义web api。【GUI】</li><li><a href="https://github.com/chengww5217/picgo-plugin-qingstor-uploader">PicGo -plugin-qingstor-uploader</a>: PicGo插件与添加的青石图片托管。【GUI】</li><li><a href="https://github.com/upupming/picgo-plugin-vscode-migrator">PicGo -plugin-vscode-migrator</a>: PicGo从<a href="https://github.com/Spades-S/vs-picgo/">‘ vs-picgo ‘</a>导入图像的插件【GUI】</li><li><a href="https://github.com/gclove/picgo-plugin-super-prefix#readme">PicGo -plugin-super-prefix</a>: PicGo自定义图像文件名和前缀的插件【CLI&amp;GUI】</li><li><a href="https://github.com/xlzy520/picgo-plugin-smms-user.git">PicGo -plugin-smms-user</a>:针对SM注册用户的PicGo插件。MS【GUI】</li><li><a href="https://github.com/bugwz/picgo-plugin-gitlab">PicGo -plugin- GitLab</a>: PicGo GitLab上传器【CLI&amp;GUI】</li><li><a href="https://www.npmjs.com/package/picgo-plugin-bilibili">PicGo -plugin-bilibili</a>: PicGo上传bilibli【CLI&amp;GUI】- <a href="https://github.com/zhanghuid/picgo-plugin-gitee">PicGo -plugin-gitee</a>: PicGo gitee上传器【CLI&amp;GUI】</li><li><a href="https://github.com/lizhuangs/picgo-plugin-gitee-uploader#readme">PicGo -plugin-gitee-uploader</a></li><li><a href="https://github.com/jiajiajia343434/picgo-plugin-nextcloud-uploader">PicGo -plugin- NextCloud - Uploader</a>: PicGo - Uploader for NextCloud【CLI&amp;GUI】</li><li><a href="https://github.com/Dec-F/picgo-plugin-watermark">PicGo -plugin-watermark</a>: PicGo的水印插件【CLI&amp;GUI】【v2.2.0+】</li><li><a href="https://github.com/PicGo/picgo-plugin-quick-capture">PicGo -plugin-quick-capture</a>: PicGo【CLI&amp;GUI】【v2.2.0+】快速截图及上传插件</li></ul>]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 效率工具 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJI大疆嵌入式秋招记录</title>
      <link href="/2019/10/01/dji-offer/"/>
      <url>/2019/10/01/dji-offer/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="a85f45f8c71c24af74034eaebc1f3e3a1a9bba5dbe68990d3b0615e34baefcc7">e898b40d052ded995b23c4672b59d678557dd647bb9bb4126e5d5a880e3d861335f988bd2947d77622dfe0c738e6e74cccd5f61b8e4b258e3fbab390b4ab189978fc7bcd2491060344a271895c9839d64325cbc3c7d555c8715567c60d6706bdfb10388432b0cc6ed4742b607454bba5531e08fd81633bd9cd0e7151f0eda7ecf530ad3792fbfbba0333e377df27f4b295fd4c1848d58bc81e6dc3e386e6d6e214d2a96a810974547cf618a5efc4e3b831ed29a6f2d8e0adb5c602587e0730bab98602c6674b83fc7679a7e9a6e79f42e0e6cc9ab3b260155fdef3ae1b6beeb8d20cb10f0a0c2cc89074d3218b96237fe0a2801ed3b8ecde38a9ed9c763051a54438b3d04e8c7fbe6b7c47bc2da845c285798a2497cf32174ead93b0b845d1798a96300fe069ef256cbf9aa2362201cccde12a1f5242cfec1b9d8efdac961361be397a0ca10262773acab4db7f7ad4f6c445bbf477fd1b54aec908fd0bf6976a3cc88b26e211513815a05e344bfb8963da1b989a2635147c26746a68debbd5e9ff5fa23b3bab874a4c8873f3b850e3ef336b21b0db961617a92ee326ecb83f4ff155814da5835844d481248754dfbaac39768b0918a887d0c920204e59efb051f3ffc9ac75122cf172ae7e6a4f52983776023cc0cba046784390bee904d9931cb17b3afb18dccfaf0776bd003bde675104fb2416a1b798ce23103166a092752c9f989bbe26004a9a9604cb98a0b6ea80ef81c5e83848efb685afeeb3a8c7d089d7e2b4795e1bb746042a325640350a1ce0ce520f64cf3ae847ad7551cc93b01e1de6a70c529ccf624206de8f40abbe6a64581b5aa1307d4148742b712b63d9a9edc156fac274b7693c9018bc878b0c67ff0144c01633356c7c7df53cbb408ee2316f69f03532eff0c68ab7d92cea9e6406eaa7f40f7bb4aeb5648f69722da12884dab11edc8f4b07fff1d6c47663091b9ef38d8d27552db98cb6bdebcf22221e2e831c4ec37883edb3ced7964754da2da1418de13a3f5e7d3b59bd0769bb3ccde53a1bafcf2f62fc351320854656235dc6f776e35f975f8eb6b1cdfca8c1c57f6970bd3a3086a070691623ad1be33f2b69c490882054759b5f425d815937d6768b67e2e85170d05fe136ddc4307a6e2168fc3df0b8af079ba1c184c3c6a0cf3738aa82843c7464407aa7acbc3754c84d24bb7d842df3fa00e58f9fe6712db60ca1b17a0b1617f2e1ad395a5be930ee3040a8a6f24726c6fac10c5e6833cc85c43b3d621c60c67346e252c5985003a946caa6eda9289a89f2a9403ddf9aad49befd9bb1b1a589db72c301a7d19bd3febffcf7e4f749b96b659cada1d430e3c4229fa0b173aa58c511ad3dad58ae5a7b0b58df6ffd3585f1495caf73e6f8ad6bcb43e8324ad1f90f2db7b02d4dee8471dac7e32bd854a2439e3690d4cf2fcd801ee7e8dcd6a6370752fb99e9f67e1b6add6e2e8aacd530823ea7eff9b87a3af68ef13901e161acfa23aabdcdeabbfde85a0af136e4d677f1a41a11167270d517a6992c1c27a68dcf9dafadf1d8961c08423d8fabdbdd9c40fd73492a7134c60f33ae35c09fcaf3ca7a3f9b3b03939e5f8114c8ee1201d7e45a91812ff0fe0ae06331688cabd173b16a427eb434303a90646f39ff01c26995b37d2d111ec84e064b48f011611ee7d1d85d997ec5665d59fec1e7f449f3c47633c7dfcec5754996f15b00c0d29e3f9753d4a70598b69f790f5dd2795c7556a335064d5a1f57d5c648640e850a44d20251d9aff7b09545fabc6ba3e5d90bb352aab0a5c7aaed96cef93179a2789ca56a6bb5f0319369e5fee5e475e1f0043652d1b559ec9da13d0eadbec983b662f07e21a6bd03d9b7bb01b4db255f7715073ec4279431332a0d61a649ae62246de5492604c56ca53a65053f386ae889653ddd5d93d383d82eb4ca14ec0e23505013a33dc65fca25e05ec0af46e7c40ae92e415ea645736057785e2e7f7b3da9a27ac9570c18ee1d1419e9845673086d95e56d24b16627f9b58b5df64840ff3130da335f21251507c2ec827fd28b75e82b334b2641f3d681e7f309b93b8bf022df6ee3a3014f414ca38d4780b24126d7a9a93c581178aaa1132ab74aa00871ff44b7bbb29223e15d6c8fb770afb2d029b6e5de0fb7e8caf3fa3292d1b537f6a8dadf28e212c10901f176ff001cf3e3769eb37e2c6596d4537c3737f5bb19a8001547ade2a69614253d0029400d55323d4a4719a72c703340a43d565b292812c12ae73514da293eac994a19f420a1dc1ef0355e89317443dcec8082b93c9a29807b7aafbc2e6d908423433094e4006f30bff5774ebf17b90014a148dfb283f1dbaae78b497f14acf6b851884861b16b05059c1696f3d927e4993a3132f62775d1c5e74dd0b61f3cf425fd28e9caa781d25993af68e5ea9e64aaedf7f29d6b5b35b70737f226da3b0a0881af7d44a964cf240b201ccfd2e7d2d619b57031393243e7ee2c71e07496a67f4583e4d0a54e62a75efee9001c1aab00c790dd5c7893490b23d48755c96adf7415af9341b32825b01e90f469a586a97d0c543b274043de99c288b1a8cd2fbe255027ffa4c4812aecaaf315e4c849005fb974240faffb972b8ed64f78aaed7d06eae9450543a9dcfcd35f8278e016a1103759d22ac3d775a43aab56140db14a195df80dff42909e5f0cc9e2034ac032523bdd422d3a55c020f448a673a54c1cf59bdda5329bc8919844082098f11d7b93e7dbbc530ca83e07629e07148ecd06152f62129fd736af7efc4ca6e8447b7c82839d7f824d6d6d7c5e5e0e6d5c944b156b1de3d1e2c72aecd4c498ed509342180cb1ac40acda9eb82cb426b29bef2bd4e1e6619b109d85b441110866043646ae7a24f3e8bd2d73bcb270d4d065c7c234314f2ec1c5ff683292d672a871fca4f1661138c4ddc1acd3207d8773fa63610cc6bfc1c85f38ad5d114f515f7cd833778637d0a6f240af18858ce41f7864a524d0e92467c0e2b8d2f6aa13dfc1e00112477c7f0b893b62341342c04d2f35a635edf615fd069791b6d82e99d0452365cea521318a8ab06419cdc52064b4e4d09aaa367303f8f5e03c6b19966daa8228e18eb672ff2778ce8ff0c052a8d6d6b585a08cb0c56a1095760161c7e08e0fbc1d13220d81356e6ea457e46e8a5d1cc05108ecda61ca4122ef55326bdb3699fc3c8b1880f395a42132b8fb8642d496d8677829b88a123e91bc23005eab019048fac552ca59cbc5a48a96b0353183a154b78af0d6ab17c7c9012fa75660c20c57dda70d84efeda117a739826ac8f957cad499e2d74ce9a69ebfbd53006d83c26cb8edfc24741efe85f2a3c036faf4717d5f5e5c298bdbc3555c824a6263c47147aea4855563b735c90f1b9c1d38b853a89ce74557c15c166287b7f353ee1d312eb740e1ebfc0f263b24cd8fd8a7777a52573b3d39bf57791b87080f665f7964f3edeb34bda0298ceba9e744c9494ed2922fcdd4a8330cc86a0940257222df841d4d526c8f7f3e7068ee0383ee3abcd0005bae82461d2df8938f80da809ad0fcab3eb674be07c101121d63cd03ed3cda130d9bced57f8a1f66dc47c983f63d6be6cdd23f4ea7b31193bbfac376d625ddcd5c6530b674a6738624d44d4c9ad93cb573eaaf427caa8c4e263ce951827758925f3def216673226d98ff59db0c386f991f6ccaa3ceae72a43e60fcfc329ffcfeefc2c5eabe9f5bc76b776e9eeaaac34a5905cb8b9392cbec993ae34e2f69591e82ae90dde27d706f3de1d392bf5f60fb1b693c31f267522991346ee578b764b31188aaf655278999003b92d4bb676e2bae87596d92829e7160ac22f383b98fbbb91273e3e2370b112c08d1f0b8590b71e5890d22f1f43c18487fda383d3197e865b8f6a5498c10c694cf6f3fc97513940ba49927eb76bde5aefa731194b4954555206cae26f5b08df573a9d81d571111bf97d6cc8595b58f3bbde36038d09bb798353fcb70ef023f61db83d352436e8f42779792641ba21145ae09c9d93cc8eaff4adc4f838b335b278c179e2fa58a75cfcbce5d2e5544849feef38e14bb8d405b4f4b081cc8fa0299c8b0f6e380d563a7f4593f57d42ec03b43e3e0607f248024a88871a441f98827e7c3d067ae2c0a6937a13818432af0e5cf43ada2cf4c2dc07fa04feee5216743d453885909fa529a72945ae3609866a07a0a8e160db1af16e61ff110a251fbf8d6e75ad91333ffc732efaaf473d11cacd179cb5f6dda7edd30d809115a650d46c1ca4001d981627bdf2a9583d2567553abe1bff42d8603fa57f52c76dd2e939661e23b0122945a86a0c05d0c38b2c67d151637ababe16fcecf6f60c160afad257ca5e7effc6dc406de90a99a318f34e801013c89772edd4871185250531e6ac064498fce7daa023e71006ea907b20bb5c2c47514b8441bd3389cc84bcd0f1141b1116409ac6e8e58b15287329637afbb0e42c41e4dd64ab60bb5c8a8a28aab0b9e55b984279e339393aedc8df35f9b0ae1c9ecbc4d9ef69c7149890640fca82d52f7a06ed3da2de5ad6792b41dd10dcd839d701a9548d61262a92aa67bc929168dbd4b739cce573b1cd6a0edbfcfef01181973713aef365241f26d78241d45ee40116fc3953a6115dbdcd0e151dc41a2154fd1a6cd6431a0bda989fb44821baa48d9f61d8002b0b5a80fc4331d913dc57a34492903f0a2dd97444b63b1469b7dee43d1e31feaf159b92ebe646d233cfcd6886b9f325e24c455a3c253407ad3aacc630e605934e39bbcd7262c1559f306c18d4be53a1237944046b5c9ecfd2d68c177e03029ed3bc6edd9dac6ff103669f307c06cb186dd69082af705f6851239d4280b151fa0a50aabe2977c919198e3ce7409846040182a013c74b1d8eb9eda3d45618e356de7108418cf1c75162b008c359a08b77f84c98bb1c329ddc0686bf6cdf80db237b8c0aded3e8070649cc90cf300fea4a46607937dcfe6b5a83157993983a0b6b4eae577ea1f85933165e655ecf5ba30fc243146212fd392400183762e3a29c7e236120676c8e293f6c815e760d3ba41e9832b10033a2bf1734d08f48b7ce6734b12a7a9d58486a8575a2e02ccdd9e73435ed3708e7895122418e8c163a97a773389ff6421100ae5b800fb089a771237fe58ce87daac265f10a6d6f64c03104e290df46184992a1924f92e9f87c96340160c0bcbacf9909bdd62a5132683360ffd2a21773d91ee0f084127029962e753b2926b03f1970058b779ee51a105d1262b05ee38e1f9d8c62437cf711cb521bd9d2b298c18d31a3a81258c6ddb74979bc6edade7f8be6f7c2a2e07e453d5628e4e1d725049c43a7ba5ae6407a13937e120309679f103b245ee40e4fdabdd4f5e54290f42201afef9fa4d9d54134edc22fe14ec0a4058f1eb3a1586615a6f6359c5ffd257f29a4a3ddd3d9aaa1a86de545e56c969653be565b13875f8afc3daafb508d28a4d6cdfa2b4db1538e2f7ba5ad04c0e2f0b6e875a759b56d862ae6831de72668d7108098e5d8e1ed1d1a2cef072def223f6cdb6087be0e0820264f92af1d2c35db1bbb4ce3b503c8402d59db65bdcdb1763d2754f75a0632527841f44e4fa6e08aa342db02f3a68614af2a333e1a218b682d107b3de80ae3bea5b6d60d6aad65ea5f318d086b8b2141a1bf0d6a162cd6a08c12b717dfdf203f2c4e89e1a4509a37cfcff91db232bfeaef6497bc6f3a35573ec8d4f5467c3889f69990fbf920d17c36b6bafe51a0adff07a93744df50e737dfeea34f01fbdde06fffda4e77de15aa22b388eded906b5eeea5f61529a44ca4aebdf877d37a636819b66c3f0592724bb6d153474b2ffe095f9889f505bae155d33e36613057deaa5b99d32281b495b61c43fb41d62879bd0589d6560b0f88a0b8001adc267decdcde94f34b216591e7aabbdd67378d56c4b07e84297da8ad9617d4c984e4195f174975aa2ca0f9c84f35f4eadad4831026f00dea6296aa5f1a3c3647385e0fc8ae661f386a903372954b082636744a02d7cf5be5e014dc890825ca69f28bc203e947cb58afcb25c5df83d10318485c857e609d123e1179f7058db527524c23eef99731c8e09b8beaf73e1b4b1543bc3a5a742f2a6d112453f7db96a26ae9495047bfef70aa2c93380e66231f380db75c4757fff9625e66028c76e8c6b6e55cf5e88977aefd51eefec9ef95885edbb9f0e34ecdaf3897ed80fe38b3fb680c242ef9d5b699520a509bc2810da16249550cea430f22a35537c8d18dc8d2b67538c886e2457c7b6b2236741fc14903bcd14c43c0f73a57c6debdf64c4c9c828d63fe702d6ccfabe79dbe13f8e9de75f009aa645066daa4ef1ec1db8ecba94c1e29312517905aecc4b915c57cd40d40d46e9963a5fa9f8d42eeed2c1a90b0d95b3800dc7d66d070195895f2f9423139a1757821318846427b82cbc78d8786dc52fb97ab74b67aaa968eca60408f06d8a0b426f8256f7746859298bd60e5145276d6f18ba97de8d14d67c500abaa01d4ec111646995fbf61a73027971600d1163553170dcc1e109dd091c849075e1cabb73c148cd19def0bf2a47b55620afe0aee163c311c930843aa7c9209d79058f61499bdc747886ff69800cacf5196a7fad5aa85f016e914e7cdbdcd63f2251d44162962c0d4cfd3e6c76e2af409980663dc129caae9328170ad6aec947cb89f3886430884d83c53832eafa9af5b33fb4e7238f4673465cc3631c5342ebbc05e1083f4fefecf1f417d2b24af305420a8be8dd873dd0b995824590dacef65bb23f8be3cc35502c19cf1ff0d83d4edf8c19ca729b4b56c326527a0b82493354d250ce7c24f93f9c23d2f6c9093295e1da0215fa21a61ba390d2f2a024e5e273501ac171dc69f68c049c6516b34d0563a6eb23591ad988050372aefad9b459ded348a6f583d12cdcc89ee89257ef23924013740f12e2ae2b8c7b6d0127a8b73ab6f4d1d3459fbb5904f8068bde11f32e9d4e0a4fd8269744be42ed319b508ca72da7ef575b0fd8cb05ee954cf743ed37b6367718792b162c63aa7878b597bf5b9eb65d96c30474a54c6f274e77827995796df1ad9f17c79dc4556b20f0aef2ce9a03cef868ef6cbd4253a4b48dc59bcdca6dc24b8b005216ee867b66cef1163d547476a1717adb7b0ad895e44d5cc11ab9064d143b26cfd9c8fdcf9febc6098ff3ad5a23cab4db748a185ad736995f993ee9dd0b32679cf19da4d32f7a3d3668d510a4877bc177d2dcef1fe75dd324ac94b8008fcf5faa13df6e9d25e839163a79e36b1e15a05c978f433661db6a0215bbfbfe08778f00b5dac02e7573c7558ea5984b0620a603f9ec5d38052a4801861a262af7abccdc77e324ca0a56632214e9e5418a3cfe07da78adbcd98ff020203b30ce1d0112d2cbe155f650cafe5859337877ef69a5c992e85cf8ec0bcc4f8a0d9e204d29410c0579208d48e5b4dc8132997debfb787ca5f4c364219c670ce890fac7000fad3a0f790ef9f85e0d2e7f416d3a6fb446c09d7421b9db5ee3a4eff88b1d29b1027396e8ea9acc6724d9678121c58f1a44eba25b73f477d7d494f9b8f5c072af077c6f6260481843fb7d6c72a00d5685f7b9edd904a519256e4838bbae6a2a01863b243ab5aac75e32708492cd7c47ce53428a7ea113c80b8ae05e4c3cc75cbcfd3d9638f632bf0405cb8aa0b0b24626ff0c32a7e403bbe16ab3bcaa974e7f1a27756f6cf51fa33389301ebaa6de1380202229f2bae23ec3f8c1cc02e3c66de7197f3fead6edbd3d8278d325e74b39a467b3f2f013f7377d63c64954c25e79bf95dbb1e1dd43e1120da6c20f04d4b82f3ab15136e3a7a7b65b05e5698399bd1a870db865652721a657359975c19f70de884095d11221b96a6c962bd016788abc3b73a1eabcc32e294ea8426c9a99e8e5d8791098c7d70f3262ca0d6c2e0d2e3d0e223389ae6b8005442b615e87294688f0a265c641bad7e694ee94e55eae57e9b838fe8acbfae2722fbf541e3a99dd008ffd698d02ce21cbfd1a88243f95b77437b27b07abb99acd96fb7f55424d8999ba3ee426805d7c775802f080c28ccfe41da08e4a646305c30009f79264129c48d426c4700bb5a1b4b68a7ae73a9d4a6d2a1d4adcc7c279b1770f2c861793ec118c76f94e13d5f4f700b2131381e3f348d4fc872dcaf70172d403dc4f40e33011436f5efe42aa6e4213f7506e4ab632b345671be1f7da2af1e42898ecb052eba6540575b79a441c3546fa6ed45a6f199a320852d89ecf47a7186d42fa8457881110e2e3d08ad06555804ac51f8c920866b44ae9d31288d50f71d34d7c6f2ac50bade333d43e460c589c32f28e9c429c041f21c729da7e9dfae4943b5c5ea2d6ef9fde1f77ac214d35b5a9de7e1bd604ceede60fcad97f2bda69ee3e715394d7ca84c059f322df21ade3819e7cc0e5e8fcd428d01d4cf276e7496afab414bbddd35b02aaece3ac156b2d2ed1d20930f72d7bbf0c8b29889f1d680e06be7d20192155186442cdb400e282e71612b3fb5c4ccb64cf7e1fb731a66fc6039ea96ce05765cb7c0c408eeb808582ae0bcedb723a4c14624f54b5895bf1cde75a63f984cfd16d0c88d499586e42116943332208b934f1095508f36e001421030c576e11a56c6b8097acdc00c974e5e825ae45bde29a01cd4b01900863507ac81e150d9d8958a60038431e76703a91c86bcf529195232665e5badb1aae4325714f4b2c488714bb479649d9ebc4b5be2fec5ffd7e8772aaf3d4698a95795114d71996c72a90056a4d953a6a45cce3d92428cc23e820b6b01d8c6bf5eb7898fd9f68ac98755898333bd8427fd17fafb632cac9fa3e9b00e1f664576447faaa337560ab95ca87cc8e1f1f04822ffbef4ac00a973706c681ddf12a795d852c25f7608b3bf63a79dfdad801d97a29a5fd76d189a4a0a4bca57720b75732c82da54ab37a70a642504a21371b0a409583d960df315e6d0a41f37a7963e895eb4945e8fd52c12631ea4ae7c87c3ac38cbff6e75e8a82712b8e501998dc06b6f92dd095fef580102851ef0195f6971ba61df7fc188324f27308927fb7a457c7acca921805dd3587fbc829f4654e2db818de018d3133f232f8cf09d11ef1214c83617bfebf23edef4337caac67ba3f842a70968612f25390b7da2d4c2db83bb6ea4c3915621b519e9e398b9406884b3a65f04a7dba3a8e34a00b8517c8af700651c1c49fa8231c0a092c1028d95945c16ec7c6dbda1b14873aa4957ee7ea8c94e2ea6cd36996ec84c1635f4a2c3da7e20d7d6122e07d11ae036da9f07321c87c8671145a1664344531fe43d03e2a8699740c48df6596b8d7cc0044a77973afb746320be9b75831309d08fbba62760e721b1dda447f5db71ad47bab4ba50fd53cbce91c8e71fece29a7f44b795f551dc49c9c139fca2a8e30c74ba1502290c700e1decab3b05ea298973836bb5fedc14e38773d81f378aa18b79352cfb5954ec9467ea19589cbe92153c8d0affd141bf4b49dbe449b39c2436dd3aa7fff9b389c3817f0fd1d0ecb0938eee21643e8742e8effe7683c25db1a3a7ebe7d644ee55f266f59dac92f394212cb0aefeed5eb538b51d844e42c29136e4bdfaf0d8e0b4a5b82cac71fb92ec176bdc087b59284b95df6942d06f8793f864adcbdd93e5cd040d0d41bfd0952de9d1f5fb707fc915b301f34b8c371427ce9d28e8bbf526fb8a4e1a786faa965345f665843e129d9d791f97dcfab40c0f2e58d4e7f685cf94b046eb434e7efad2bc474e1b21bbed53109e9081cb1073fe735b06cb7910803fcae0d2b01a026d7b4525e48c5c8cc973794b4e1f97f37be84dd77fb4a9af9eb5f0450ba05b7d2693cd6e5c527fb7eaa369766ff5a3e518b2232800408d4c677d46d73063005114741cd6770f2cdc170bfbdbcdb0dc362c3a957b5befd433b541c9e82be385d4bbc183c541f2e06ab8b529c4e9834480217ff85dbc4caab252cd74b4b05306828c66e38845e57ecb736ebe70916b2aa42894eed6fbbd8df6ef86f658e5c943347dfe6e3d82ca88d83069cc647271197071c11ab3fcab6a8213ace7656b8e79ef05e43279d5ad07101943175f5ea99573728cca4d2d9958b7acdfe6c0249069ac572ee925553a7a91315e0b57e06f0b6271a10515693bb5787de14aed5f8e055b9d1e3e307fa39612a3b4594e0fdda971f2edf1b3f1fb3d702ab09cf3a4861a42bfcee3fdbe86ef83cd2ab14edaabfe691c65d45c646caeddef8a28d97d977bd970be7bac9627f22ac01ffd5ffff5c37168d792c50bc97dda8c1a98c638a26b84f5bad79593b4198648c837551217268a1e67a314281d769352505303cc558063ef9846655a6a873164c93a99934b82f674bddddb89c70669cb1c66d316879cf001dbb43b764fa0891bc842882a8488627105de7b7abebd46514aebd487fc8a7a92ccc0457e2c9767c8fe741a5000f821d0614a418a721fde05488c49b365707c5f283e192f0f1298dec198007beffa9946fa26f1935cfca19e1505281b893cc2aae0c4f11162449a2f21758c858598cdbc6087af7c774a2545be266e0b2d871f6044b97b3471edfe4ff163c37edd8879188486e1753529c3211a307bd5328ae1140c4578ce793508b12a90b7777bb8cf43498d7ebe3169b2df14c56ee79c7bded917409bdec05eecf92bf5fccfed1c26bcb203d44f94e37c5adae524789fae0c62d785a8e8d5540d01991cb3bd8f62de11176ee3ad90c10f9df1c1dfa6dc2905515991e39a8f76aed6e9d653cf8e343102b15c67908b41301f9a4e76a39a9ab10a72e12a06d9bb8d6db66bb750df5cc6034c54c3311d86f1362795b3b4723a1706145f3cda086cd876d47394f045c73d881de63a31eca65725f7cfc2400195fb9a29e2088d305930b54795a14ad23603b68b82e6a3179c5cd3c74dc13b21d64b916dc4bacacb260521ee27d0bcb984042b130273b2f562e4483d72000ab5a1846d6a6696a3a22a1132421e0cfd8afd04da6a1e1f200e587db37d455fa3f3956eb2cae53e6a71d961289b1a4f3349834b2bec45ac27da86dd680a408c7110f57b971f83b3cd3a933551d305d2cf9fd431f2131b2b614334bb707602a19a48826fa48ce50b5f43680b90afb6551bd8653c503a9f45c85773917d7ec92f84f54dcb42809f0afbfa43d2ded729ca395edae18d9781e97b15230e4e17a95135631366fcaae17e5d0337fa1c69327e07c54bdd70ccae6b9c4d94bbc7c0d5b985a890e68543d35e84b377af434694257f1f7ad7bda75b6671dc5a7e592b372134b813f68cbcdeaaca6a0bde822133ff11accbba02db23c53093421c80900d29ab6674aa04a71dd9a4765403e64c8f29cd69be3492839b24051c4cd2545dde5f186951a46e77a75e8d840ba621b0bba43c6a65fa6168728d114722c2c51cbfb87fbe925856804adc0cb4a5ca182f4c2128677e91ce4920acf7f257023f9a65e5f5f9e9a8395ad968e98cc28ee0f21828be6bf4b65b66b7acf5616fda4fe5359a0f05c9521952c45f8f97f187dc7d53d37b4821789b68a1ed0cbc545e0061932cbe1f4fe212e20cf22f982235b3770fd90b2356a286f51c0cab0e39b2e938fe1febbdadcd6fd3d4f02b0cad6cee8145ab30f7ae12dae0f1ddb32da05776242195fdacbca76c0383a0ea7635f60f1d9532b053c27afc8fb76deb18b55e6d4491328142762a3e683ebdbb3d62dd3b6a95367cc5f4b074ddecd58449e29ba12e0715872958e90b327a40432f07a031dd77ad8316cf81c8f418ab14c15c5ffc92726c3653720e05c5f46a40da640336b3af6a64b893fb6654a82cc82cabba263229cd10888ea8b663c008ab5fe3c4c4509af3bf06f59dd36192779c8fd9388b49ebe263e20fa914a98fd20f0ebfd3af46b177b86caeb965075d37b5444e2c5fc0e9e845aab41c6dbcbd4e67d993bceed00dfaeb0ada7b33f5ae057233900e8407962243b462f51b8fbde4e2da8ac2e3a160c451bce04d32bd97cd48978d1695b8e0843739773c37d875b366fe23e65c37321f94dd8f65a949153dea2436c2f93f0afcf2b9f75b4cd926170d7ef44b47b9b38657facaf193b8a8a29464133ab6d711fd437fec4beeec27e5c58d050a8e772baf6f953a73a2e1d3f7cbdf4a83cfc3d14393f457c22c93e5747b9ef5dda85822235b14f44adf2c4655b195a302637cc6ac113085a80fa94b12751cfe866d2f19bc80f559ca11f926d153973246b48e9418f87b29dd91de7da5f699c928fef3ec8e715a5e43fb6d4f01c21a40e60b963f8e8a18fec1561282cd6044d3c5b12b35579911a49b76ba713133f89508082235eb10a7e79ad10dde2720e2c592c8f10fab632a17f2ea8dd3fbd17ce127550121dbb919a57b4a2c727371f3a0d7e98d44c0300b4d3bcd086fd68c90a08de08f3bdba17107bf9c1182a4cf6ec288bf99970b4f65f864f9180908c01a2d431a384e50bcb84441e892211e2b57b152b47f5944d01c6bb5bfc48960ae1e955bf101c5b90c01b0e9da9b5a033830b847f0b1fc8c368137eb2cec34db212d41fb1cd85907ef5f6b618596024b05cfafebec6bab97f13a1f5e8240b2678ba22f20758be666915f8b859be16c8215d44679dfbdec917449ebdf0202824036232f50149393cd7bc09e17fb2c6ba08cfbff6fa42b6c19e46c90f47a2b240610c089bec9f6193f03a7d6885e66562891b3c603c2fc1b5f8c49d9f836c370c5c1b443bba20c5f404163c9d489a76c4ad07486466efc945be65c93e1af0845e0b5d76c8f4d57f76ad9e46ae6b7d6ad1736f912441cbb6ed4e9d0bce3bb4288970032620e0bfb25af29dfc4ea6621e4a2545d3b00ea4fa419bf89e919ff55fbf8b18e14eeb345b9977387d0a9605b99caaf406d3747b6f574a0827bd0f6dd062d6a9f869151dd72dd63c42b2d07d9488fbf4527a1a4401cf988bfad835c26384da790819c5bf639078b6e9949c0d6b29d305b755146bc1d44f747f99de1e5881b7e2dffc3c155e79b45eb39e261052b716c04e0e3f7ef84aad9ad745dc73ffd21f9b4003aa308e5cd3f980ab76fd149afe02fb148a1f0473316896a4d941cf514c33d91ef1c4133c0307d6b8ee52a9ccb7a024168f44ed14867b961f48ee5f47e488d02ffab8a3826b8483d0ff05822657191803fe334153694d3f962a9bc468dbac16352e497ca1d31720af98ea6f3eaed5cf003c064ac22c10e3aaccbb84f008185699bb223a94eea06f141c2b62346158ae80bc1ed6b84d61ceae8b50a35b32fe46483590fb5048113fd805805bf0024fc39fcc4e9c7709e0c089f924591584c55d3c45aee22fab8dfb9484155036a3d6e97d04de4c4256ef058bded4992b546c6533ad19d0e061a4149267ca53719cb8a85c2da7d3ae41b89bb94f8c276dff3e71f52517859142f59d05ec3215aa7fc42be72e13dd87ab79be2a197237a0540dcbbb4d7c3083382377b879b5d551042e891c7d4b43c4ef2c763826653a00b1f0a82ed90c4d4c76199a35c1ac15e97fdabd151a564150c9a3e21d50e7a1ef6e59a4cc88472426e1aab292d9620a2392fcb5786976e255c994eb01daf3c464206006511fdda8cacd2a4bbb5ef6b18283ead38ac1f942a00807ff6b58d286fb49f5cc7fec27f3bb21a6d6963e5f3939c6ffb99c4555fd6259a8af5df578c7f1ce15fcf0b4a34e340fac5b926f542cb16e61579d2990a6d21011e1bdc0856dea687c5088923da160a161b6bdf2d7dc67d99db18c7b9a21f41e44128e39e408ed35d8a9d48c3624afac9066af49af04017ef070c4bfd3c8ebe185c8ea4998b50a2ad215952084fcff11e89e2f3374dc65ad4267c7451e263d909a1e608dc0120ee4af1f353ddc55906ea083eb7c573a1a2226aed0ee121f976b0f712f7380ad1fb85480d030eea86189046f26ba44fb96955bb286a7ae887dc62bb1b1660292f24721f7a9a58e8b690266af0eec82a547a7dc12fe783ad12bce1af9290d2eeb36e659c74f85d47618639afa3e2f0931fa986ff7f8a7c9d9584ad4b680c7bc2f240b10637a99eb99ed3475cd36ee45973520514bf5090ee75453589d4d2c1c4f8692f388b2cfb45653520c1f9e8da44e0b3f4397decef8956b1f6e801b020c7e90f713bd5b6caca5aaf303d7787944526523922ebbab2b80ab2d72825f6299298e8dcb4f8812f55ba972dd212bdfec64c056ffcb4f90617e7c82c2bc555eba6369bff70a084e5e66db5337406ce01e6ece0e4a4be693023f40c81553dcf7437dc7964fd202cd0ed58e9b86191c3e5251a192ecdca31462d8ae38f922d0d51be7217d2d10c53dcf1e9964c0d847dde714495a4c90bd24c10b26e9c7426fcd4327d0f0d010ffab1e4a8a80a8f847db5a3a3f664b2b795604515b200e7797f55f3fc3531b91f169e0d98f115f8135f9603448134b7c7e53abf394f93f30050ac029702800eadc6e3114898183f900a7d91b12493d17a173540f88cea0df49e42b5c846153bf79549e46d0c41391a02e0e8b75c37ffd626b0a8e0b3dc5cc943c9c64ae6f7510c521e1dda895f41719ef4b80c4106dd752303d63479f4270e44b66e2a4c451ab4c343a1826abfb82a256e77890c3ada40e3c46e76abc9f30aed705b3a2b4b559f9a00324e0bb3a8b057201fb19c6ccb735ddb0bd4b8fe30c22250680ad7ac3a9fb4f415286a9497d6be4f26ca6dcb58306f9d5b4c3b7c94ebfc27374dc6887b6effbdfe6e7f1a31134a07b2bdd15f4183a35f76d3cf9888eceb119bbf15faec5dec8077445c332ce78f2270969c1d68e59227e968734ce786e509888b10f45b0a842b5bbb595e139edf39aa89a76f4a116330438bd3100c92724fce25ac8f062d24ec3e9aa0451a25945ad905f7388f6bb445058cc28ee6dbfa7af0f98c5a547be9701dd0f0f910059025fc96fdc1749e9a2133e9b8e3d925b1a917f0eb792e69a66d9d2d7a760468e250b64633faedfa253abe66690dfdb6169d71d2bebb457344d3026a5d5438d307d312375ff63cadcf5474f467bf1ff8507dfa6afb0c26c2c0fcf0e2cdb38cc9b946303543b0257c0d39680b72af935da17e039ec849b1805d80bca9ce03335cdea95c92a62ae494fa0cd58b76f5a4ce798ec3e37bcd0337282f24a4496254b03c2f935247bb5fea33ace5f05177927a93119c06740bb9b05603536c148ff23031ded85bc2b752a31dd1c5e49358733bb14b1c3bcbdde81aeecd8cd891bfca089</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019电赛——纸张计数显示装置</title>
      <link href="/2019/09/01/2019-electronic-design-competition/"/>
      <url>/2019/09/01/2019-electronic-design-competition/</url>
      
        <content type="html"><![CDATA[<h2 id="Github项目地址"><a href="#Github项目地址" class="headerlink" title="Github项目地址"></a><a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition">Github项目地址</a></h2><h1 id="纸张计数显示装置😄"><a href="#纸张计数显示装置😄" class="headerlink" title="纸张计数显示装置😄"></a>纸张计数显示装置😄</h1><p align="center">  <a href="https://zengwangfa.top/">个人主页🕺|</a>  <a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/blob/master/docs/%E8%AE%BA%E6%96%87/%E7%BA%B8%E5%BC%A0%E8%AE%A1%E6%95%B0%E6%98%BE%E7%A4%BA%E5%99%A8%E8%AE%BA%E6%96%87.md">电赛论文📚|</a>  <a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/software">软件说明💻|</a>  <a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/blob/master/mechanical">机械说明🎮|</a>  <a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/hmi">交互界面说明📺|</a>  <a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%84">综合测评📐</a></p><hr><p align="center">  <img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/logo.jpg"></p><p align="center">  <a href="https://www.stmcu.com.cn"><img src="https://img.shields.io/badge/Device-STM32F407-brigreen.svg?style=flat-square"></a>  <a href="https://www.rt-thread.org/"><img src="https://img.shields.io/badge/OS-RT--Thread-brightgreen"></a>  <a href="https://img.shields.io"><img src="https://img.shields.io/github/repo-size/zengwangfa/2019-Electronic-Design-Competition?style=flat-square"></a></p><h2 id="1、简介✏"><a href="#1、简介✏" class="headerlink" title="1、简介✏"></a>1、简介✏</h2><blockquote><p>纸张计数显示装置基于<strong>RT-Thread</strong>实时操作系统，硬件平台采用<strong>STM32F407</strong>单片机为主控制器，以具有抗电磁干扰（<strong>EMI</strong>）架构的FDC2214模块作为电容采集传感器，通过<strong>屏蔽双绞线</strong>连接至两铜极板，读取采集的数据并进行相应判断，应用触摸屏和语音模块进行状态显示与播报。FDC2214模块将采集到的数据通过IIC协议传输给主控制器，主控制器对原始数据进行<strong>卡尔曼滤波</strong>，抑制噪声对数据采集的影响。校准模式下，本系统利用最大隶属度法，确定电容模拟值及纸张数的论域，定义模糊子集和隶属函数，建立模糊规则控制表，求得模糊控制查询表。其根据采集到的两极板的数据，做出短路判断并读取多组实时数据，将其与模拟区间进行归类，选取<strong>最大可能性区间</strong>作为期望值，减小最终判断的差错率。</p></blockquote><ul><li><input checked="" disabled="" type="checkbox"> 成果：在校准好后，50张以下<code>100%</code>正确</li></ul><hr><table><thead><tr><th align="center">配置参数</th><th align="center">主控制器</th><th align="center">配置参数</th><th align="center">主传感器</th></tr></thead><tbody><tr><td align="center">芯片型号</td><td align="center">STM32F407ZGT6</td><td align="center">芯片型号</td><td align="center">FCD2214</td></tr><tr><td align="center">CPU</td><td align="center">32位 Cortex-M4(ARMv7)</td><td align="center">分辨率</td><td align="center">28位</td></tr><tr><td align="center">主频</td><td align="center">168MHz</td><td align="center">通道数</td><td align="center">4</td></tr><tr><td align="center">RAM</td><td align="center">192KB</td><td align="center">接口</td><td align="center">I2C</td></tr><tr><td align="center">外存</td><td align="center">1MB(FLASH)</td><td align="center">最高输出速率</td><td align="center">4.08ksps</td></tr><tr><td align="center">单元</td><td align="center">FPU、DSP</td><td align="center">特性</td><td align="center">抗电磁干扰(EMI)</td></tr></tbody></table><hr><ul><li>系统结构简图：<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84%E7%AE%80%E5%9B%BE.png" alt="系统结构简图" title="系统结构简图"></li></ul><h2 id="2、目录说明🔖"><a href="#2、目录说明🔖" class="headerlink" title="2、目录说明🔖"></a>2、目录说明🔖</h2><h4 id="STM32F407控制程序在："><a href="#STM32F407控制程序在：" class="headerlink" title="STM32F407控制程序在："></a>STM32F407控制程序在：</h4><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+——2019-Electronic-Design-Competition</span><br><span class="line">|---+ software:【软件设计】</span><br><span class="line">|       ├──README.md</span><br><span class="line">|       ├──rt-thread-master</span><br><span class="line">|            └──bsp</span><br><span class="line">|               └──stm32f407【控制程序】</span><br><span class="line">|                  └──project.uvprojx【Keil5工程】</span><br><span class="line">|---- ...</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><table><thead><tr><th align="center">目录名</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">2019电赛题目</td><td align="center">2019年电赛A-H题题目及器件清单</td></tr><tr><td align="center"><a href="./docs/">docs</a></td><td align="center">数据手册、设计图片、参考文献及设计文档</td></tr><tr><td align="center"><a href="./hardware/">hardware</a></td><td align="center">FDC2214、核心板原理图及PCB</td></tr><tr><td align="center">hmi</td><td align="center">串口屏幕设计UI及交互程序</td></tr><tr><td align="center">matlab</td><td align="center">matlab函数拟合及Kalman</td></tr><tr><td align="center">mechanical</td><td align="center">机械结构设计</td></tr><tr><td align="center">others</td><td align="center">一些关于电赛前的准备</td></tr><tr><td align="center"><a href="./software/"><strong>software</strong></a></td><td align="center"><strong>纸张计数显示装置STM32程序</strong></td></tr><tr><td align="center"><a href="./%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%84/">综合测评</a></td><td align="center"><strong>综合测评题目及Multisim电路仿真</strong></td></tr></tbody></table><h2 id="3、机械结构-hammer"><a href="#3、机械结构-hammer" class="headerlink" title="3、机械结构:hammer:"></a>3、<a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/blob/master/mechanical">机械结构<span class="github-emoji"><span>🔨</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f528.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></a></h2><ul><li>3维模型<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/3D_structure.jpg" alt="3D效果图" title="3D效果图"></li><li>实物图<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/metal_struture.png" alt="铰链结构实物图"></li></ul><h2 id="4、软件说明💻"><a href="#4、软件说明💻" class="headerlink" title="4、软件说明💻"></a>4、<a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/software">软件说明💻</a></h2><p>应用线程总体分为：</p><ul><li><p>1.简单设备运行线程</p><ul><li>LED</li><li>OLED</li><li>Buzzer</li><li>Flash</li></ul></li><li><p>2.主测量应用线程</p><ul><li>HMI屏幕交互</li><li>FD2214数据获取与转换</li><li>语音模块交互</li></ul></li><li><p>3.系统监控线程</p><ul><li>Watch Dog<span class="github-emoji"><span>🐕</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f415.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></li></ul></li></ul><h2 id="5、硬件结构-artificial-satellite"><a href="#5、硬件结构-artificial-satellite" class="headerlink" title="5、硬件结构:artificial_satellite:"></a>5、硬件结构<span class="github-emoji"><span>🛰</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f6f0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></h2><p><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/Controller_3D.jpg" alt="Controller PCB 3D" title="Controller 3D"></p><ul><li>核心板(Core Controller)拥有外设：</li></ul><table><thead><tr><th align="center">外设名称</th><th align="center">RGB LED</th><th align="center">Key</th><th align="center">Buzzer</th><th align="center">Dial Switch</th><th align="center"><strong>FCD2214</strong></th><th align="center">USART HMI</th><th align="center">OLED</th><th align="center">W25Q128</th><th align="center">Voltage Detection</th><th align="center">Current Detection</th><th align="center">Zigbee</th><th align="center">JY901</th><th align="center">USR-C216</th><th align="center">CP2102</th></tr></thead><tbody><tr><td align="center">控制(通讯)方式</td><td align="center">GPIO</td><td align="center">GPIO</td><td align="center">GPIO</td><td align="center">GPIO</td><td align="center"><strong>I2C</strong></td><td align="center">USART</td><td align="center">SPI</td><td align="center">SPI</td><td align="center">ADC</td><td align="center">ADC</td><td align="center">USART</td><td align="center">USART</td><td align="center">USART</td><td align="center">USART</td></tr><tr><td align="center">功能描述</td><td align="center">指示灯</td><td align="center">按键</td><td align="center">蜂鸣器</td><td align="center">拨码开关</td><td align="center"><strong>电容传感器</strong></td><td align="center">串口触摸屏</td><td align="center">显示屏</td><td align="center">闪存芯片</td><td align="center">电压检测</td><td align="center">电流检测</td><td align="center">2.4G无线通信</td><td align="center">九轴</td><td align="center">WiFi模块</td><td align="center">串口转USB</td></tr></tbody></table><ul><li>整体实物图<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/all_structure.png" alt="整体实物图"></li></ul><hr><h2 id="6、交互界面-framed-picture"><a href="#6、交互界面-framed-picture" class="headerlink" title="6、交互界面:framed_picture:"></a>6、<a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/hmi">交互界面<span class="github-emoji"><span>🖼</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f5bc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></a></h2><ul><li><input checked="" disabled="" type="checkbox"> 电脑调试时的交互界面展示：</li></ul><p align="center">  <img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/github/paper_hmi.gif"></p><h2 id="7、测试数据分析-bar-chart"><a href="#7、测试数据分析-bar-chart" class="headerlink" title="7、测试数据分析:bar_chart:"></a>7、测试数据分析<span class="github-emoji"><span>📊</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4ca.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></h2><p>(1)<br>保持测试环境不变，采集50个样本，通过MATLAB拟合出纸张页数与传感器原始数据的曲线关系，如图4-2所示。</p><p><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/fitting.png" alt="拟合曲线" title="拟合曲线"></p><p><strong>图4-2 纸张页数与模拟量的拟合函数关系图</strong></p><ul><li>(2) 根据(1)中采集的50个样本，确定电容模拟值及纸张数的论域，划分模糊子集，如表4-1<br>所示。</li></ul><p><strong>表4-1页数与模拟量区间对应表</strong></p><table><thead><tr><th>页数/张</th><th>对应模拟量区间</th><th>页数/张</th><th>对应模拟量区间</th></tr></thead><tbody><tr><td>1</td><td>[1680.00,1345.34]</td><td>6</td><td>[682.48,633.84]</td></tr><tr><td>2</td><td>[1345.34,1013.26]</td><td>7</td><td>[633.84,598.03]</td></tr><tr><td>3</td><td>[1013.26,845.12]</td><td>8</td><td>[598.03,569.46]</td></tr><tr><td>4</td><td>[845.12,748.79]</td><td>9</td><td>[569.46,546.28]</td></tr><tr><td>5</td><td>[748.79,682.48]</td><td>10</td><td>[546.28,529.16]</td></tr></tbody></table><ul><li>(3)根据（2）中划分的模糊子集，保持测试环境不变，固定测量35张纸张，采集数据如表4-2所示，采集到的原始数据90%落入35张页数所对应的区间[401.35,399.50]，如图4-35</li></ul><p><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/35page.png" alt="35张纸区间图"></p><p><strong>表4-2 纸张数为35的实时数据</strong></p><table><thead><tr><th>测试组别</th><th>原始数据</th><th>测试组别</th><th>原始数据</th></tr></thead><tbody><tr><td>1</td><td>400.896</td><td>6</td><td>400.824</td></tr><tr><td>2</td><td>401.049</td><td>7</td><td>400.591</td></tr><tr><td>3</td><td>400.157</td><td>8</td><td>401.111</td></tr><tr><td>4</td><td>399.912</td><td>9</td><td>400.443</td></tr><tr><td>5</td><td>401.125</td><td>10</td><td>398.529</td></tr></tbody></table><ul><li>测试结果</li></ul><p><strong>表4-4 工作模式下纸张测试结果表</strong></p><table><thead><tr><th>范围</th><th>测试次数</th><th>正确次数</th><th>正确率</th></tr></thead><tbody><tr><td>1~10</td><td>25</td><td>25</td><td>100%</td></tr><tr><td>11~20</td><td>25</td><td>25</td><td>100%</td></tr><tr><td>20~30</td><td>25</td><td>25</td><td>100%</td></tr><tr><td>30~40</td><td>25</td><td>25</td><td>100%</td></tr><tr><td>40~50</td><td>25</td><td>25</td><td>100%</td></tr><tr><td>50~60</td><td>25</td><td>23</td><td>92%</td></tr><tr><td>60~70</td><td>25</td><td>20</td><td>80%</td></tr><tr><td>70~80</td><td>25</td><td>16</td><td>64%</td></tr></tbody></table><h2 id="8、综合测评演练-triangular-ruler"><a href="#8、综合测评演练-triangular-ruler" class="headerlink" title="8、综合测评演练:triangular_ruler:"></a>8、<a href="https://github.com/zengwangfa/2019-Electronic-Design-Competition/tree/master/%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%84">综合测评演练<span class="github-emoji"><span>📐</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4d0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></a></h2><ul><li>选定2017综合测评题目【符合信号发生器】，进行综合测评训练<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/2017%E5%B9%B4%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%94%B5%E5%AD%90%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%84%E9%A2%98.jpg" alt="2017年全国大学生电子设计竞赛综合测评题" title="2017年全国大学生电子设计竞赛综合测评题"></li></ul><p>虽然测评训练的时候做的还行，但是实际当天综测比赛的时候，还是会手忙脚乱，现在想起那天焊接电路颤抖的双手都有点好笑<span class="github-emoji"><span>🤣</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f923.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji"><span>🤣</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f923.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>。</p><ul><li>综测训练测试结果：<br><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/2017%E7%BB%BC%E6%B5%8B%E8%AE%AD%E7%BB%83.jpg" alt="2017综测训练" title="2017综测训练"></li></ul><h2 id="9、分工-family"><a href="#9、分工-family" class="headerlink" title="9、分工:family:"></a>9、分工<span class="github-emoji"><span>👪</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f46a.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></h2><ul><li><p><input checked="" disabled="" type="checkbox"> 电路设计</p><ul><li><input checked="" disabled="" type="checkbox"> 硬件搭建 by <a href="https://github.com/zengwangfa">@Ian</a></li></ul></li><li><p><input checked="" disabled="" type="checkbox"> 控制程序</p><ul><li><input checked="" disabled="" type="checkbox"> 整体框架 by <a href="https://github.com/zengwangfa">@Ian</a></li><li><input checked="" disabled="" type="checkbox"> 交互界面及通信 by <a href="https://github.com/zengwangfa">@Ian</a></li><li><input checked="" disabled="" type="checkbox"> 核心分割算法 by <a href="https://github.com/Okurarisona">@Okurarisona</a></li></ul></li><li><p><input checked="" disabled="" type="checkbox"> 机械结构</p><ul><li><input checked="" disabled="" type="checkbox"> 结构方案设计 by <a href="https://github.com/JackyLin1205">@JackyLin</a> </li><li><input checked="" disabled="" type="checkbox"> 固定铰链式抗干扰结构 by <a href="https://github.com/JackyLin1205">@JackyLin</a></li></ul></li><li><p><input checked="" disabled="" type="checkbox"> 论文</p><ul><li><input checked="" disabled="" type="checkbox"> 论文 by <a href="https://github.com/Hyf338">@Hyf338</a></li></ul></li></ul><h3 id="赞赏"><a href="#赞赏" class="headerlink" title="赞赏"></a>赞赏</h3><p><img src="https://zengwangfa.oss-cn-shanghai.aliyuncs.com/csdn/%E7%BB%99%E8%B5%9E.png" alt="赞赏" title="赞赏"></p><h4 id="整理纪念"><a href="#整理纪念" class="headerlink" title="整理纪念"></a>整理纪念</h4><ul><li><a href="Mailto:zengwangfa@outlook.com">点击联系我</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello Hexo</title>
      <link href="/2019/07/24/hello-world/"/>
      <url>/2019/07/24/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="1-参考资源"><a href="#1-参考资源" class="headerlink" title="1.参考资源"></a>1.参考资源</h2><ul><li><a href="https://github.com/hexojs/hexo">Github Hexo</a></li><li><a href="https://hexo.io/zh-cn/">Hexo 官网</a></li></ul><h2 id="2-安装软件"><a href="#2-安装软件" class="headerlink" title="2.安装软件"></a>2.安装软件</h2><h3 id="2-1-Windows"><a href="#2-1-Windows" class="headerlink" title="2.1 Windows"></a>2.1 Windows</h3><ul><li><a href="https://git-scm.com/downloads">git下载官网</a></li><li><a href="https://nodejs.org/en/download/">nodejs下载官网</a></li></ul><h3 id="2-2-Linux"><a href="#2-2-Linux" class="headerlink" title="2.2 Linux"></a>2.2 Linux</h3><ul><li><code>git</code></li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br></pre></td></tr></tbody></table></figure><ul><li><code>Nodejs</code></li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nodejs</span><br></pre></td></tr></tbody></table></figure><blockquote><p>安装完成,查看版本号,可检查是否安装成功</p></blockquote><ul><li><code>node -v</code></li><li><code>npm -v</code></li></ul><h2 id="3-安装Hexo"><a href="#3-安装Hexo" class="headerlink" title="3.安装Hexo"></a>3.安装Hexo</h2><blockquote><p>以下命令都在<code>git bash</code>中输入运行</p></blockquote><ul><li>cd至需要创建的文件夹blog下，安装Hexo（Windows在<code>git bash</code>窗口中输入）</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli  </span><br></pre></td></tr></tbody></table></figure><h2 id="4-快速创建"><a href="#4-快速创建" class="headerlink" title="4.快速创建"></a>4.快速创建</h2><h3 id="4-1-初始化博客"><a href="#4-1-初始化博客" class="headerlink" title="4.1 初始化博客"></a>4.1 初始化博客</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init blog</span><br></pre></td></tr></tbody></table></figure><ul><li>切换至博客目录</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd blog</span><br></pre></td></tr></tbody></table></figure><h3 id="4-2-创建文章"><a href="#4-2-创建文章" class="headerlink" title="4.2 创建文章"></a>4.2 创建文章</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new "Hello Hexo"</span><br></pre></td></tr></tbody></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="4-3-生成静态文章"><a href="#4-3-生成静态文章" class="headerlink" title="4.3 生成静态文章"></a>4.3 生成静态文章</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></tbody></table></figure><ul><li>可简写为<code>hexo g</code></li></ul><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="4-4-启动服务"><a href="#4-4-启动服务" class="headerlink" title="4.4 启动服务"></a>4.4 启动服务</h3><blockquote><p>在预览时才需要用】启动hexo,会生成本地连接:localhost:4000<br>如果4000端口被占用可以用：hexo server -p 5000(指定端口5000)</p></blockquote><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></tbody></table></figure><ul><li>可简写为<code>hexo s</code><br>More info: <a href="https://hexo.io/docs/server.html">Server</a></li></ul><h3 id="4-5-部署文章"><a href="#4-5-部署文章" class="headerlink" title="4.5 部署文章"></a>4.5 部署文章</h3><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></tbody></table></figure><ul><li>可简写为<code>hexo d</code><br>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></li></ul><h2 id="5-更换主题"><a href="#5-更换主题" class="headerlink" title="5.更换主题"></a>5.更换主题</h2><h3 id="5-1-下载"><a href="#5-1-下载" class="headerlink" title="5.1 下载"></a>5.1 下载</h3><p>点击不同的主题的代码，将其文件夹复制到你 Hexo 的&nbsp;themes&nbsp;文件夹中即可<br><strong>推荐的主题：</strong></p><ul><li><a href="https://github.com/blinkfox/hexo-theme-matery">matery</a></li><li><a href="https://github.com/litten/hexo-theme-yilia">yilia</a></li></ul><h3 id="5-2-更换主题"><a href="#5-2-更换主题" class="headerlink" title="5.2 更换主题"></a>5.2 更换主题</h3><blockquote><p>初始化默认主题为landscape</p></blockquote><p>切换主题修改 Hexo 根目录下的&nbsp;<code>_config.yml</code>&nbsp;的&nbsp;<code>theme</code>&nbsp;的值：theme: <code>hexo-theme-matery</code></p><p><code>_config.yml&nbsp;</code>文件的其它修改建议:</p><ul><li>请修改&nbsp;_config.yml&nbsp;的&nbsp;url&nbsp;的值为你的网站主&nbsp;URL（如：<a href="http://xxx.github.io)/">http://xxx.github.io）</a></li><li>建议修改两个&nbsp;per_page&nbsp;的分页条数值为&nbsp;6&nbsp;的倍数，如：12、18&nbsp;等，这样文章列表在各个屏幕下都能较好的显示</li><li>如果你是中文用户，则建议修改&nbsp;language&nbsp;的值为&nbsp;zh-CN</li></ul><h2 id="6-绑定域名CNAME"><a href="#6-绑定域名CNAME" class="headerlink" title="6.绑定域名CNAME"></a>6.绑定域名CNAME</h2><ul><li>当你点击保存的时候 Github Pages 会自动帮你生成一个 CNAME 的文件在根目录，里面的内容就是你绑定的域名地址</li></ul><p><img src="https://ina-blog.oss-cn-shanghai.aliyuncs.com/CNAME.png"></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>观想之宙</title>
      <link href="/2019/06/28/the-three-body-problem-x/"/>
      <url>/2019/06/28/the-three-body-problem-x/</url>
      
        <content type="html"><![CDATA[<blockquote><p>我看到了我的爱恋<br>我飞到她的身边<br>我捧出给她的礼物<br>那是一小块凝固的时间<br>时间上有美丽的条纹<br>摸起来像浅海的泥一样柔软<br>她把时间涂满全身<br>然后拉起我飞向存在的边缘<br>这是灵态的飞行<br>我们眼中的星星像幽灵<br>星星眼中的我们也像幽灵</p></blockquote><h1 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h1><p>《三体X·观想之宙》是一本由<strong>宝树</strong>著作，重庆出版社出版，为大刘《三体》系列外传</p><h3 id="作者简介"><a href="#作者简介" class="headerlink" title="作者简介"></a>作者简介</h3><ul><li>宝树：北京大学本科、硕士，新锐<strong>科幻作家</strong>。<ul><li>著作：长篇小说《时间之墟》、短篇小说集《古老的地球之歌》</li><li>多次获得中国科幻银河奖、华语科幻星云奖等</li></ul></li></ul><h3 id="作品目录"><a href="#作品目录" class="headerlink" title="作品目录"></a>作品目录</h3><ul><li>1.楔子</li><li>2.上部：时间之内的往事</li><li>3.中部：茶道谈话</li><li>4.下部：天萼</li><li>5.尾声：普罗旺斯</li><li>6.后记</li><li>7.尾声之后：新宇宙纪事</li></ul><h1 id="二、阅读记录"><a href="#二、阅读记录" class="headerlink" title="二、阅读记录"></a>二、阅读记录</h1><h2 id="1、本书主要内容"><a href="#1、本书主要内容" class="headerlink" title="1、本书主要内容"></a>1、本书主要内容</h2><p>  本书主线或者说<strong>主要矛盾</strong>——<strong>“主宰”与“隐藏者”的斗争</strong>。  </p><p>  什么样的斗争？隐藏者的目的究竟是什么？主宰作为宇宙之主为什么会有敌手？开头设定“隐藏者”这一新角色，激发了极大的阅读兴趣。</p><p>  本书主人公为被三体人所复活的云天明，三体人不断用残酷的梦境折磨云天明说出其真实的目的，但是这种手段不仅没有让云天明屈服，反而使其逐渐锻炼出超卓的心智。</p><h2 id="2、本书中宇宙十维模型的解读"><a href="#2、本书中宇宙十维模型的解读" class="headerlink" title="2、本书中宇宙十维模型的解读"></a>2、本书中宇宙十维模型的解读</h2><p>原文中<strong>云天明</strong>与<strong>智子</strong>的对话</p><blockquote><p>“三维宇宙存在了多少时间？”他转向智子，目光炯炯地问。<br>“按地球年来计算，大概是138亿9400万年。”智子很快给出了答案。<br>“四维宇宙呢？”<br>“100万年。”<br>“五维宇宙是？”<br>“131年。”<br>“六维宇宙？”<br>“九天。”<br>“七维？”<br>“两分钟零三秒。”<br>“八维？”<br>“12毫秒。”<br>“九维？”<br>“31纳秒。”<br>云天明按捺住内心的兴奋，问出了最终一问：“那么，十维宇宙呢？”<br>智子罕见地沉默了片刻，然后说：“永恒。在十维宇宙中不需要时间。”<br>“我早该想到，”云天明喃喃道，“无限的速度，无限的效率，一切从开始就已经完成，瞬间达到完满，不需要任何间隔……这是一个没有时间的世界。”<br>“没有时间，没有运动，没有变化，没有过程……开始即结束！刹那即永恒！没有活生生的生命，只是无穷张胶片的叠加。这是一个——死亡的世界。”<br>“我不明白，”智子说，“我真的不明白你在说什么。完美的世界本来就不需要时间。时间只是……令人厌恶的延迟而已。”<br>“因为你是主宰的影子，”云天明说，“和主宰一样，时间就是你的盲点。你根本上并不是生活在时间里，你也永远看不到时间本身。我给你讲一个地球的神话吧。”<br>“我知道所有的地球神话。”智子不屑地说。<br>“但是你不一定能了解其意义，不是么？否则你可能早已经明白隐藏者的动机。在希腊神话里，天空之神乌拉诺斯和大地女神盖亚结合在一起，生出了许多的诸神。但是乌拉诺斯厌恶这些儿女们，用生殖器把他们顶回了盖亚的子宫，不让他们出世，而天与地也处于永恒的结合状态，无法分离。后来盖亚因为被乌拉诺斯所包围和挤压而感到痛苦，让她的儿女们去消灭父亲乌拉诺斯，最后她的儿子克洛诺斯砍下了乌拉诺斯的生殖器，让乌拉诺斯离开了盖亚，从此天与地分离，诸神出世，宇宙万物才具有了生机。”<br>“这个粗俗无趣的故事和十维宇宙的事有什么关系？”<br>“克洛诺斯就是希腊语的‘时间’。这是一个隐喻，时间让一切开始。隐藏者需要的就是时间，没有时间的宇宙，再大都太小了。所以隐藏者无法忍受，必须要降维。每降一次维，时间就延长至少上万倍。隐藏者不是疯子，也不是恶棍，他们只是需要一点——时间。”<br>“对于隐藏者来说，降维就是为了创造时间，所有消失的维度，都将通过时间获得补偿。它们——或者它们的一部分——都以某种方式被转移到了时间中！这就是降维的积极意义！没有降维就没有时间！”<br>“也可以这么说，我们早已经发现，时间本身是对光速降低的一种补偿性效应。”智子若有所思地说。</p></blockquote><p>  宝树将起源宇宙描述为十维世界（完美的世界）——“永恒。在十维宇宙中不需要时间。”光从世界的一端传到另一端，速度无限。</p><p>  “无限的速度,无限的效率，切从开始就已经完成，瞬间达到完满,不需要任何问间隔.-这是一个没有时间的世界。<br>“没有时间,没有运动， 没有变化，没有过程….始即结束!刹那即永恒!没有活生生的生命，只是无穷张胶片的叠加。这是一个死亡的世界!”<br>脑洞极为惊奇，但是却也是漏洞百出。</p><p>这也揭示了<strong>宇宙降维</strong>的真正原因——隐藏者需要的就是时间，没有时间的宇宙，再大都太小了。<br><strong>隐藏者</strong>不断让宇宙降维，以获取更多的时间。时间本身是对光速降低的一种补偿性效应。</p><h2 id="3-云天明的主角光环"><a href="#3-云天明的主角光环" class="headerlink" title="3.云天明的主角光环"></a>3.云天明的主角光环</h2><p>  不得不承认是主角，在某种程度上都会有一定的主角光环，在本书尤为明显。<br>在其与三体人无限梦境的斗争中，云天明大脑的思想或者说意识有了超出常人的跃进。<br>其拥有能逃避高科技探测意思的“思想黑箱”——简单来说，就是将自我意识，放入自己开辟的“黑箱”中，躲避高科技对其真实想法的探测。</p><h2 id="4、歌者与“王”之间的凄美爱情"><a href="#4、歌者与“王”之间的凄美爱情" class="headerlink" title="4、歌者与“王”之间的凄美爱情"></a>4、歌者与“王”之间的凄美爱情</h2><p>  在<strong>星渊族</strong>即将灭亡之时，歌者所吟唱也揭示了一部分本书的秘密。</p><blockquote><p>我看到了我的爱恋<br>我飞到她的身边<br>我捧出给她的礼物<br>那是一小块凝固的时间<br>时间上有美丽的条纹<br>摸起来像浅海的泥一样柔软<br>她把时间涂满全身<br>然后拉起我飞向存在的边缘<br>这是灵态的飞行<br>我们眼中的星星像幽灵<br>星星眼中的我们也像幽灵</p></blockquote><h2 id="5-感想"><a href="#5-感想" class="headerlink" title="5.感想"></a>5.感想</h2><p>  宇宙处于无限归零当中，宇宙不断衰减，衰减至尽，则重现归零，不知是毁灭还是新的重生，或许对于现宇宙当中的一部分为毁灭，对下一态宇宙为新的重生。</p><p>  无限轮回这个象征永恒的主题，把剧情推向了高潮，“一切有什么意义呢”——哲学最终极的问题。不变的轮回有意义吗？不断衰减的轮回又有意义吗？到底哪种是毁灭，哪种才是救赎？</p><p>  知乎网友八云说：“大刘曾经表示过：他本来有意继续写三体，但是因为宝树的三体X的出现，他放弃了。”<br>网上骂声一片，被形容成毁掉了一个这么好的IP，也确实，本来对其预期极高，但看完之后，略感失望。<br>不过本书也是有一些亮点，例如对<strong>宇宙降维</strong>的原因，虽然解释的优点荒诞，但不得不说脑洞惊奇；再者 对<strong>歌者</strong>的继续出境，引出一段凄美婉转的爱情故事。<br>最大的一点对主角云天明的过大夸张，有点对其某种意义上的“意淫”，略有浮夸。</p><hr>]]></content>
      
      
      <categories>
          
          <category> 阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 阅读 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MJPG-Streamer推流测试</title>
      <link href="/2018/12/02/raspberry-mjpg/"/>
      <url>/2018/12/02/raspberry-mjpg/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/jacksonliam/mjpg-streamer">mjpg-streamer Github</a></p><p><kbd><strong>用到的工具材料</strong>：</kbd></p><ul><li><input checked="" disabled="" type="checkbox"> 树莓派3B+</li><li><input checked="" disabled="" type="checkbox"> 网线</li><li><input checked="" disabled="" type="checkbox"> 电脑</li><li><input checked="" disabled="" type="checkbox"> CSI摄像头</li><li><input checked="" disabled="" type="checkbox"> USB摄像头</li></ul><blockquote><p>实现的功能有：<br>①树莓派通过网线将CSI摄像头与USB摄像头的实时画面推流至上位机电脑中的显示<br>②实测双摄延时低至200ms以下</p></blockquote><p>我的另一篇博文中介绍了使用树莓派H.264硬件编解码推流CSI摄像头，所以本文仅介绍如何用 MJPG-Streamer推流USB摄像头实时画面。所以需要同时推流双摄时，可选择CSI+USB Camera或者双USB Camera。</p><h1 id="总体流程"><a href="#总体流程" class="headerlink" title="总体流程"></a>总体流程</h1><p>1.树莓派硬件连接与软件及驱动安装<br>2.上位机PC端的接收视频流<br>3.延迟效果测试</p><h2 id="1-硬件连接与软件及驱动配置"><a href="#1-硬件连接与软件及驱动配置" class="headerlink" title="1.硬件连接与软件及驱动配置"></a>1.硬件连接与软件及驱动配置</h2><h3 id="1）检测是否存在USB摄像头设备"><a href="#1）检测是否存在USB摄像头设备" class="headerlink" title="1）检测是否存在USB摄像头设备"></a>1）检测是否存在USB摄像头设备</h3><p>输入以下指令：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ lsusb</span><br></pre></td></tr></tbody></table></figure><ul><li>未插入USB摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ lsusb </span><br><span class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</span><br><span class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ul><li>插入USB摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ lsusb</span><br><span class="line">Bus 001 Device 004: ID 05a3:9230 ARC International</span><br><span class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</span><br><span class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ v4l2-ctl --list-formats</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ v4l2-ctl --list-formats</span><br><span class="line"></span><br><span class="line">ioctl: VIDIOC_ENUM_FMT</span><br><span class="line">        Index       : 0</span><br><span class="line">        Type        : Video Capture</span><br><span class="line">        Pixel Format: 'MJPG' (compressed)</span><br><span class="line">        Name        : Motion-JPEG</span><br><span class="line"></span><br><span class="line">        Index       : 1</span><br><span class="line">        Type        : Video Capture</span><br><span class="line">        Pixel Format: 'YUYV'</span><br><span class="line">        Name        : YUYV 4:2:2</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><table>    <tbody><tr>        <td><center><img src="https://img-blog.csdnimg.cn/20181202170523751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图1  还未插入USB摄像头 </center></td>        <td><center><img src="https://img-blog.csdnimg.cn/20181202170531278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图2 插入USB摄像头</center></td></tr></tbody></table><h3 id="2）安装-MJPG-Streamer-from-github"><a href="#2）安装-MJPG-Streamer-from-github" class="headerlink" title="2）安装 MJPG-Streamer from github"></a>2）安装 MJPG-Streamer from github</h3><blockquote><p>按照以下命令安装MJPG-Streamer及其相关配置 每一行为一个命令</p></blockquote><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cmake libjpeg8-dev</span><br><span class="line"></span><br><span class="line">wget https://github.com/jacksonliam/mjpg-streamer/archive/master.zip</span><br><span class="line"></span><br><span class="line">unzip master.zip</span><br><span class="line"></span><br><span class="line">cd mjp*g-*</span><br><span class="line"></span><br><span class="line">cd mjpg-*</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">sudo make install</span><br><span class="line"></span><br><span class="line">cd $home</span><br></pre></td></tr></tbody></table></figure><p>流程如下<br><img src="https://img-blog.csdnimg.cn/2018120219295880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><h3 id="3）启动MJPG-Streamer"><a href="#3）启动MJPG-Streamer" class="headerlink" title="3）启动MJPG-Streamer"></a>3）启动MJPG-Streamer</h3><blockquote><p>启动如下指令：<br>TCP端口8085被指定为输出端口，以确保没有对其他任何东西的干扰。</p></blockquote><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br></pre></td></tr></tbody></table></figure><p><img src="https://img-blog.csdnimg.cn/20181202185954705.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70" alt="树莓派推流成功"></p><p><strong>如上图所示，推流已经完成，分辨率为720P(1280X720)，端口号为8085，到此树莓派的任务已经完成</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">pi@raspberrypi:~ $ /usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br><span class="line">MJPG Streamer Version.: 2.0</span><br><span class="line"> i: Using V4L2 device.: /dev/video0</span><br><span class="line"> i: Desired Resolution: 1280 x 720</span><br><span class="line"> i: Frames Per Second.: 10</span><br><span class="line"> i: Format............: JPEG</span><br><span class="line"> i: TV-Norm...........: DEFAULT</span><br><span class="line"> i: FPS coerced ......: from 10 to 60</span><br><span class="line"> o: www-folder-path......: /usr/local/share/mjpg-streamer/www/</span><br><span class="line"> o: HTTP TCP port........: 8085</span><br><span class="line"> o: HTTP Listen Address..: (null)</span><br><span class="line"> o: username:password....: disabled</span><br><span class="line"> o: commands.............: enabled</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="4）开启指定摄像头"><a href="#4）开启指定摄像头" class="headerlink" title="4）开启指定摄像头"></a>4）开启指定摄像头</h3><ul><li>USB设备存在两个摄像头</li></ul><p><img src="https://img-blog.csdnimg.cn/20190507154817290.png"></p><ul><li>如果你有多个摄像头，也可以开启多个摄像头</li><li>-d /dev/video1    参数标明需要开启的摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -d /dev/video1 -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br></pre></td></tr></tbody></table></figure><h2 id="2-上位机PC端的接收视频流"><a href="#2-上位机PC端的接收视频流" class="headerlink" title="2.上位机PC端的接收视频流"></a>2.上位机PC端的接收视频流</h2><blockquote><p>采用web网页接收视频流</p></blockquote><p>打开浏览器输入：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://树莓派ip地址:开启的端口号</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// A case in point 例如：</span><br><span class="line">http://192.168.2.150:8085</span><br></pre></td></tr></tbody></table></figure><blockquote><p>输入 <a href="http://192.168.2.150:8085/">http://192.168.2.150:8085</a>   打开后如下图：为MJPG Streamer 首页<br><img src="https://img-blog.csdnimg.cn/20181202190911467.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p></blockquote><ul><li>查看视频点击Stream<br><img src="https://img-blog.csdnimg.cn/20181202190927946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></li></ul><p>看到网页中有树莓派USB摄像头拍摄的画面，证明视频推流成功。</p><h2 id="3-双摄延迟效果测试"><a href="#3-双摄延迟效果测试" class="headerlink" title="3.双摄延迟效果测试"></a>3.双摄延迟效果测试</h2><blockquote><p>我们打开一个在线秒表，让其开始计时，而后我们用树莓派CSI摄像头及USB摄像头去拍摄电脑屏幕，然后截屏，计算拍摄的时间与秒表实际时间的差值，可以粗略测得延时的结果</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20181202191338911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"如上图所示"</span>    在线秒表为<span class="number">1.18</span><span class="number">.697</span>  </span><br><span class="line"><span class="variable constant_">USB</span>摄像头（<span class="title class_">Web</span> <span class="variable constant_">MJPG</span>-<span class="title class_">Streamer</span>）推流视频中的在线秒表为<span class="number">1.18</span><span class="number">.567</span>  </span><br><span class="line"><span class="variable constant_">CSI</span>摄像头（<span class="title class_">MPlayer</span>  视频播放器）推流视频中的在线秒表为<span class="number">1.18</span><span class="number">.525</span></span><br><span class="line">其差值△t1=<span class="number">0.</span>130s=130ms                  △t1=<span class="number">0.</span>172s=172ms</span><br></pre></td></tr></tbody></table></figure><p>之后我通过多次测试多种组合得到如下图数据（仅做参考）：</p><p><img src="https://img-blog.csdnimg.cn/20181202192130874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><p>总结：</p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分辨率都为 720P  延迟大致为<span class="number">100</span>-200ms之间[带光纤延迟增加并不明显]</span><br><span class="line">分辨率都为 1080P 延迟为<span class="number">200</span>-300ms</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Raspberry Pi </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSI摄像头推流</title>
      <link href="/2018/11/28/raspberry-raspivid/"/>
      <url>/2018/11/28/raspberry-raspivid/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/jacksonliam/mjpg-streamer">mjpg-streamer Github</a></p><p><kbd><strong>用到的工具材料</strong>：</kbd></p><ul><li><input checked="" disabled="" type="checkbox"> 树莓派3B+</li><li><input checked="" disabled="" type="checkbox"> 网线</li><li><input checked="" disabled="" type="checkbox"> 电脑</li><li><input checked="" disabled="" type="checkbox"> CSI摄像头</li><li><input checked="" disabled="" type="checkbox"> USB摄像头</li></ul><blockquote><p>实现的功能有：<br>①树莓派通过网线将CSI摄像头与USB摄像头的实时画面推流至上位机电脑中的显示<br>②实测双摄延时低至200ms以下</p></blockquote><p>我的另一篇博文中介绍了使用树莓派H.264硬件编解码推流CSI摄像头，所以本文仅介绍如何用 MJPG-Streamer推流USB摄像头实时画面。所以需要同时推流双摄时，可选择CSI+USB Camera或者双USB Camera。</p><table>    <tbody><tr>        <td><center><img src="https://img-blog.csdnimg.cn/20181128153213623.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图1  树莓派接线整体图 </center></td>        <td><center><img src="https://img-blog.csdnimg.cn/20181128154230707.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图2 树莓派接线整体图</center></td></tr></tbody></table><h1 id="总体流程"><a href="#总体流程" class="headerlink" title="总体流程"></a>总体流程</h1><p>1.树莓派硬件连接与软件及驱动安装<br>2.上位机PC端的接收视频流<br>3.延迟效果测试</p><h2 id="1-硬件连接与软件及驱动配置"><a href="#1-硬件连接与软件及驱动配置" class="headerlink" title="1.硬件连接与软件及驱动配置"></a>1.硬件连接与软件及驱动配置</h2><h3 id="1）检测是否存在USB摄像头设备"><a href="#1）检测是否存在USB摄像头设备" class="headerlink" title="1）检测是否存在USB摄像头设备"></a>1）检测是否存在USB摄像头设备</h3><p>输入以下指令：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ lsusb</span><br></pre></td></tr></tbody></table></figure><ul><li>未插入USB摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pi@raspberrypi:~ $ lsusb </span><br><span class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</span><br><span class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ul><li>插入USB摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ lsusb</span><br><span class="line">Bus 001 Device 004: ID 05a3:9230 ARC International</span><br><span class="line">Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter</span><br><span class="line">Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp.</span><br><span class="line">Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ v4l2-ctl --list-formats</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ v4l2-ctl --list-formats</span><br><span class="line"></span><br><span class="line">ioctl: VIDIOC_ENUM_FMT</span><br><span class="line">        Index       : 0</span><br><span class="line">        Type        : Video Capture</span><br><span class="line">        Pixel Format: 'MJPG' (compressed)</span><br><span class="line">        Name        : Motion-JPEG</span><br><span class="line"></span><br><span class="line">        Index       : 1</span><br><span class="line">        Type        : Video Capture</span><br><span class="line">        Pixel Format: 'YUYV'</span><br><span class="line">        Name        : YUYV 4:2:2</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><table>    <tbody><tr>        <td><center><img src="https://img-blog.csdnimg.cn/20181202170523751.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图1  还未插入USB摄像头 </center></td>        <td><center><img src="https://img-blog.csdnimg.cn/20181202170531278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70">图2 插入USB摄像头</center></td></tr></tbody></table><h3 id="2）安装-MJPG-Streamer-from-github"><a href="#2）安装-MJPG-Streamer-from-github" class="headerlink" title="2）安装 MJPG-Streamer from github"></a>2）安装 MJPG-Streamer from github</h3><blockquote><p>按照以下命令安装MJPG-Streamer及其相关配置 每一行为一个命令</p></blockquote><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cmake libjpeg8-dev</span><br><span class="line"></span><br><span class="line">wget https://github.com/jacksonliam/mjpg-streamer/archive/master.zip</span><br><span class="line"></span><br><span class="line">unzip master.zip</span><br><span class="line"></span><br><span class="line">cd mjp*g-*</span><br><span class="line"></span><br><span class="line">cd mjpg-*</span><br><span class="line"></span><br><span class="line">make</span><br><span class="line"></span><br><span class="line">sudo make install</span><br><span class="line"></span><br><span class="line">cd $home</span><br></pre></td></tr></tbody></table></figure><p>流程如下<br><img src="https://img-blog.csdnimg.cn/2018120219295880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><h3 id="3）启动MJPG-Streamer"><a href="#3）启动MJPG-Streamer" class="headerlink" title="3）启动MJPG-Streamer"></a>3）启动MJPG-Streamer</h3><blockquote><p>启动如下指令：<br>TCP端口8085被指定为输出端口，以确保没有对其他任何东西的干扰。</p></blockquote><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br></pre></td></tr></tbody></table></figure><p><img src="https://img-blog.csdnimg.cn/20181202185954705.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70" alt="树莓派推流成功"></p><p><strong>如上图所示，推流已经完成，分辨率为720P(1280X720)，端口号为8085，到此树莓派的任务已经完成</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ /usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br><span class="line">MJPG Streamer Version.: 2.0</span><br><span class="line"> i: Using V4L2 device.: /dev/video0</span><br><span class="line"> i: Desired Resolution: 1280 x 720</span><br><span class="line"> i: Frames Per Second.: 10</span><br><span class="line"> i: Format............: JPEG</span><br><span class="line"> i: TV-Norm...........: DEFAULT</span><br><span class="line"> i: FPS coerced ......: from 10 to 60</span><br><span class="line"> o: www-folder-path......: /usr/local/share/mjpg-streamer/www/</span><br><span class="line"> o: HTTP TCP port........: 8085</span><br><span class="line"> o: HTTP Listen Address..: (null)</span><br><span class="line"> o: username:password....: disabled</span><br><span class="line"> o: commands.............: enabled</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h3 id="4）开启指定-多个摄像头"><a href="#4）开启指定-多个摄像头" class="headerlink" title="4）开启指定/多个摄像头"></a>4）开启指定/多个摄像头</h3><ul><li>USB设备存在两个摄像头</li></ul><p><img src="https://img-blog.csdnimg.cn/20190507154817290.png"></p><ul><li>如果你有多个摄像头，也可以开启多个摄像头</li><li>-d /dev/video1    参数标明需要开启的摄像头</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/mjpg_streamer -i "/usr/local/lib/mjpg-streamer/input_uvc.so -d /dev/video1 -n -f 10 -r 1280x720" -o "/usr/local/lib/mjpg-streamer/output_http.so -p 8085 -w /usr/local/share/mjpg-streamer/www"</span><br></pre></td></tr></tbody></table></figure><h2 id="2-上位机PC端的接收视频流"><a href="#2-上位机PC端的接收视频流" class="headerlink" title="2.上位机PC端的接收视频流"></a>2.上位机PC端的接收视频流</h2><blockquote><p>采用web网页接收视频流</p></blockquote><p>打开浏览器输入：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://树莓派ip地址:开启的端口号</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// A case in point 例如：</span><br><span class="line">http://192.168.2.150:8085</span><br></pre></td></tr></tbody></table></figure><blockquote><p>输入 <a href="http://192.168.2.150:8085/">http://192.168.2.150:8085</a>   打开后如下图：为MJPG Streamer 首页<br><img src="https://img-blog.csdnimg.cn/20181202190911467.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p></blockquote><ul><li>查看视频点击Stream</li></ul><p><img src="https://img-blog.csdnimg.cn/20181202190927946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><p>看到网页中有树莓派USB摄像头拍摄的画面，证明视频推流成功。</p><h2 id="3-双摄延迟效果测试"><a href="#3-双摄延迟效果测试" class="headerlink" title="3.双摄延迟效果测试"></a>3.双摄延迟效果测试</h2><blockquote><p>我们打开一个在线秒表，让其开始计时，而后我们用树莓派CSI摄像头及USB摄像头去拍摄电脑屏幕，然后截屏，计算拍摄的时间与秒表实际时间的差值，可以粗略测得延时的结果</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20181202191338911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><p>“如上图所示”    在线秒表为1.18.697<br>USB摄像头（Web MJPG-Streamer）推流视频中的在线秒表为1.18.567<br>CSI摄像头（MPlayer  视频播放器）推流视频中的在线秒表为1.18.525<br>其差值△t1=0.130s=130ms                  △t1=0.172s=172ms</p><p>之后我通过多次测试多种组合得到如下图数据（仅做参考）：</p><p><img src="https://img-blog.csdnimg.cn/20181202192130874.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NDkyOTMy,size_16,color_FFFFFF,t_70"></p><p>总结：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分辨率都为 720P  延迟大致为100-200ms之间[带光纤延迟增加并不明显]</span><br><span class="line">分辨率都为 1080P 延迟为200-300ms</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> 记录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Raspberry Pi </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
